import{r as c,j as m,a as e,d as J,R as K}from"./app-799e35f4.js";import{T as L,a as O,b as x,c as k,d as P,e as l,f as Q}from"./table-d9dcf34c.js";import{F as i}from"./FormatNumbering-9f807289.js";import{B as U}from"./button-edb68002.js";import V from"./Action-cc7b4ab8.js";import X from"./ApprovalAkhir-eec03ab1.js";import"./utils-46f1eee5.js";import"./react-number-format.es-0305b056.js";import"./index-f96983da.js";import"./dialog-29933f57.js";import"./index-1b763624.js";import"./react-icons.esm-67107d04.js";import"./index-5c4a9a61.js";import"./card-4a10a030.js";import"./badge-3d965261.js";import"./BayarAngsuran-f5b7c352.js";import"./label-97b58594.js";import"./index-4415d72a.js";import"./input-5998a608.js";import"./index.esm-c4306c7e.js";import"./Checkbox-791cdd49.js";import"./Loading-bc9b2f98.js";import"./transition-8d92fd07.js";import"./JenisNasabah-956dc72c.js";import"./InputError-67dd8fa8.js";import"./InputLabel-f838de25.js";import"./PrimaryButton-ffe78f33.js";import"./SelectList-bcf3698e.js";import"./DeleteAngsuran-fd123797.js";import"./TextInput-caadacbb.js";import"./DeleteLoan-79850a76.js";const je=({dateOfWeek:p,datas:N,sirkulasi:y})=>{const[n,T]=c.useState([]),[g,B]=c.useState(0),[I,j]=c.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});c.useEffect(()=>{if(N){const a=N.map((r,v)=>(()=>{var D;const o={},w=(t=>Array.isArray(t)?t.length===0?{max:{},min:{}}:t.length===1?{max:{},min:t[0]}:t.reduce((s,f)=>{const A=new Date(f.date),q=new Date(s.min.date),G=new Date(s.max.date);return A<q&&(s.min=f),A>G&&(s.max=f),s},{max:t[0],min:t[0]}):{max:{},min:{}})(y);B(((D=w.max)==null?void 0:D.amount)??0);const S=(t=>{var s;switch(t.type){case"ml":return((s=w.min)==null?void 0:s.ml_amount)??0;default:return t.data.reduce((f,A)=>f+A.saldo_sebelumnya,0)}})(r);p.forEach(t=>{o[t]=0});let h=0;return r.data.forEach(t=>{p.forEach(s=>{t.instalment[s]!==void 0&&(h+=t.instalment[s],o[s]+=t.instalment[s])})}),j(t=>({...t,[r.type]:{sirkulasi:S,angsuran:h,saldo:S-h}})),{key:r.month,instalment:{...o},sirkulasi:S,totalInstalment:h,sirkulasiAfter:S-h}})());T(a)}},[N]);const C=(a,r)=>a.reduce((d,o)=>d+parseInt(o.instalment[r]??0),0),u=(a,r)=>a.reduce((d,o)=>d+parseInt(o[r]??0),0),[M,E]=c.useState(null),[F,R]=c.useState(!1),z=()=>{R(!1),E(null)},[H,b]=c.useState(!1),Y=a=>{b(!0)},_=()=>{b(!1)};return m("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[m(L,{className:"text-xs rounded-lg",children:[e(O,{className:"sticky top-0 left-0 z-10",children:m(x,{className:"bg-gray-200",children:[e(k,{className:"text-center",children:"Bulan"}),e(k,{className:"text-center",children:"Sirkulasi"}),p.map((a,r)=>e(k,{className:"text-center",children:J(a).format("DD-MM-YY")},r)),e(k,{className:"text-center",children:"Angsuran"}),e(k,{className:"text-center",children:"Saldo"})]})}),e(P,{children:n?n.map((a,r)=>e(K.Fragment,{children:m(x,{children:[e(l,{children:a.key}),e(l,{children:e(i,{value:a.sirkulasi})}),p.map((v,d)=>e(l,{className:"text-center",children:e(i,{value:a.instalment[v]})},d)),e(l,{children:e(i,{value:a.totalInstalment})}),e(l,{children:e(i,{value:a.sirkulasiAfter})})]})},r)):e(x,{children:e(l,{children:"a"})})}),m(Q,{children:[m(x,{children:[e(l,{rowSpan:2,className:"text-center",children:"Total"}),e(l,{rowSpan:2,className:"text-center",children:e(i,{value:u(n,"sirkulasi")})}),p.map((a,r)=>e(l,{rowSpan:2,className:"text-center",children:e(i,{value:C(n,a)})},r)),e(l,{rowSpan:2,className:"text-center",children:e(i,{value:u(n,"totalInstalment")})}),u(n,"sirkulasiAfter")==g?e(l,{rowSpan:2,className:"text-center",children:e(i,{value:u(n,"sirkulasiAfter")})}):e(l,{className:"text-center",children:e(i,{value:u(n,"sirkulasiAfter")})})]}),e(x,{children:g&&u(n,"sirkulasiAfter")!=g?e(l,{className:"text-center bg-red-500",children:e(i,{value:g})}):""})]})]}),m("div",{className:"flex items-center justify-end gap-3 mt-6",children:[e("div",{children:"Approval Akhir Bulan"}),e("div",{children:e(U,{onClick:Y,variant:"green",size:"sm",children:"Approval"})})]}),e(X,{show:H,onClosed:_,datas:I}),e(V,{datas:n,show:F,onClosed:z,triggeredId:M})]})};export{je as default};
