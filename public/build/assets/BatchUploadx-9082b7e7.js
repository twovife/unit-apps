import{W as X,r as c,c as w,j as e,a,F as D,l as Q}from"./app-fe7fad3d.js";import{I as m}from"./InputError-77addbdb.js";import{L as Z}from"./Loading-089255ee.js";import{B as h}from"./button-73d6c108.js";import{I as o}from"./input-9a09e38e.js";import{L as i}from"./label-aa486f71.js";import{C as j}from"./index.esm-13376736.js";import{u as aa,S as ea}from"./SelectComponent-66ac3df0.js";import{A as ta}from"./AuthenticatedLayout-c9960290.js";import{C as na}from"./Checkbox-c9b44306.js";import{T as la,a as ra,b as S,c as A}from"./tabs-8bbd327c.js";import{C as I,a as E,b as R,c as T,d as Y}from"./card-23dd34b8.js";import M from"./RiwayatPengajuan-7e06c151.js";import{S as ia,X as sa}from"./x-4a96f6e0.js";import"./transition-87b16098.js";import"./utils-36e2ef84.js";import"./index-98b842be.js";import"./index-a706c26a.js";import"./Navbar-557723f0.js";import"./createLucideIcon-9aab1fd8.js";import"./SweetAlert-ac9da124.js";import"./index-7a5494e2.js";import"./index-5a74e1b2.js";import"./react-icons.esm-38ab3c69.js";import"./index-9c12e9ad.js";import"./FormatNumbering-73b39446.js";import"./react-number-format.es-fe820e7d.js";import"./index-51441a16.js";import"./BadgeStatus-6e8b7579.js";import"./badge-7a31371a.js";const La=()=>{const{optKelompok:P}=aa(),{data:n,setData:f,post:L,errors:u,processing:K,reset:_}=X({isActiveMember:!1,nik:"",request_date:"",tanggal_drop:"",no_kk:"",nama:"",alamat:"",kelompok:"",request_nominal:"",angsuran:[]}),[s,b]=c.useState([]);c.useEffect(()=>{b([])},[n.tanggal_drop]),c.useEffect(()=>{f("angsuran",s)},[s]);const z=()=>{const t=s.length>0?w(s[s.length-1].transaction_date).add(1,"week").format("YYYY-MM-DD"):n.tanggal_drop?w(n.tanggal_drop).add(1,"week").format("YYYY-MM-DD"):"";b([...s,{id:Date.now(),transaction_date:t}])},B=t=>{b(s.filter(l=>l.id!==t))},C=(t,l,r)=>{b(s.map(d=>d.id===t?{...d,[l]:r}:d))},O=(t,l,r)=>{b(s.map(d=>d.id===r?{...d,[l]:t}:d))},[v,U]=c.useState(""),[V,k]=c.useState(!1),[y,q]=c.useState(),[p,x]=c.useState([]),[F,H]=c.useState();c.useEffect(()=>{H(n.request_date),f(t=>({...t,tanggal_drop:n.request_date?w(n.request_date).add(1,"week").format("YYYY-MM-DD"):""}))},[n.request_date]);const $=(t,l)=>{f(l,t)},g=t=>{const{name:l,value:r}=t.target;f(l,r)},G=t=>{const{name:l,value:r}=t.target;U(r),x([])},J=async t=>{t.preventDefault(),_(),k(!0),q(),await Q({method:"post",url:route("transaction.nasabah_buku_transaksi"),data:{nik:v}}).then(function({data:l}){k(!1),f(r=>({...r,nik:l.return_nik,isActiveMember:!!l.data})),l.data?x(l.data):x([])}).catch(function({response:l}){q(l.data.message),k(!1)})},W=t=>{t.preventDefault(),L(route("transaction.store_buku_transaksi_batch"),{onSuccess:()=>{_()}})},N=t=>{const l=t.target.getAttribute("data-value");f("request_nominal",l)};return e(ta,{children:[a(Z,{show:V||K}),e("div",{className:"flex flex-col w-full gap-3 lg:flex-row",children:[e("div",{className:"w-auto",children:[e("fieldset",{className:"w-full p-4 mb-3 border rounded-lg",children:[a("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Cari Nasabah"}),e("form",{className:"w-full mb-3",onSubmit:J,children:[a(i,{optional:!0,children:"NIK"}),e("div",{className:"flex items-center gap-3",children:[a(o,{type:"text",name:"nik",value:v,onChange:G,placeholder:"Cek NIK"}),e(h,{className:"text-xs",size:"sm",children:[a(ia,{className:"w-auto h-4 mr-1"}),"Cari"]})]}),y&&a(m,{message:y,className:"mt-1"}),e("div",{className:`font-semibold mt-1 ${v.length==16?"text-green-500":"text-red-500"}`,children:[v.length," Digit"]})]})]}),v&&n.nik==v&&e("fieldset",{className:"w-full p-4 border rounded-lg",children:[a("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Detail Pinjaman"}),e("form",{className:"w-full mb-3",onSubmit:W,children:[e("div",{className:"flex gap-5",children:[e("div",{className:"flex-1",children:[e("div",{className:"flex gap-3",children:[e("div",{className:"w-full mb-3",children:[a(i,{children:"Tanggal Pengajuan"}),a(o,{type:"date",name:"request_date",required:!0,value:n.request_date,onChange:g}),a(m,{value:u.request_date})]}),e("div",{className:"w-full mb-3",children:[a(i,{children:"Tanggal Drop"}),a(o,{type:"date",name:"tanggal_drop",min:F,required:!0,value:n.tanggal_drop,onChange:g}),a(m,{value:u.tanggal_drop})]})]}),n.request_date&&n.request_date==n.tanggal_drop?a("div",{className:"w-full mb-3 font-semibold text-red-500",children:"DROP BARU"}):a("div",{className:"w-full mb-3 font-semibold text-red-500",children:"PENGAJUAN DROP"}),e("div",{className:"w-full mb-3",children:[a(i,{optional:!0,children:"NIK"}),a(o,{type:"text",name:"nik",value:n.nik,disabled:!0,onChange:g}),a(m,{value:u.nik})]}),n.isActiveMember?e(D,{children:[e("div",{className:"w-full mb-3",children:[a(i,{children:"Nama"}),a(o,{type:"text",disabled:!0,value:p.nama??""})]}),e("div",{className:"w-full mb-3",children:[a(i,{children:"Alamat"}),a(o,{type:"text",disabled:!0,value:p.alamat??""})]})]}):e(D,{children:[e("div",{className:"w-full mb-3",children:[a(i,{optional:!0,children:"NO KK"}),a(o,{type:"text",name:"no_kk",value:n.no_kk,onChange:g}),a(m,{value:u.no_kk})]}),e("div",{className:"w-full mb-3",children:[a(i,{children:"Nama"}),a(o,{type:"text",name:"nama",value:n.nama,onChange:g,required:!0}),a(m,{value:u.nama})]}),e("div",{className:"w-full mb-3",children:[a(i,{children:"Alamat"}),a(o,{type:"text",name:"alamat",value:n.alamat,onChange:g,required:!0}),a(m,{value:u.alamat})]})]}),e("div",{className:"w-full mb-3",children:[a(i,{children:"Kelompok"}),a(ea,{value:n.kelompok,options:P,name:"kelompok",nullvalue:!0,onChange:g,required:!0}),a(m,{value:u.kelompok})]}),e("div",{className:"w-full mb-3",children:[a(i,{children:"Nominal Pinjaman"}),a(j,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"request_nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:$,value:n.request_nominal,placeholder:"Inputkan angka tanpa sparator"}),a(m,{value:u.request_nominal})]}),e("div",{className:"flex flex-wrap w-full gap-2 mb-3",children:[a(h,{type:"button",variant:"outline",size:"xs",onClick:N,"data-value":"500000",children:"500.000"}),a(h,{type:"button",variant:"outline",size:"xs",onClick:N,"data-value":"700000",children:"700.000"}),a(h,{type:"button",variant:"outline",size:"xs",onClick:N,"data-value":"1000000",children:"1.000.000"}),a(h,{type:"button",variant:"destructive",size:"xs",onClick:N,"data-value":"0",children:"reset"})]})]}),a("div",{className:"flex-1",children:s.map((t,l)=>e("div",{className:"flex gap-3 mb-3",children:[e("div",{className:"w-full",children:[a(i,{children:"Tanggal Storting"}),a(o,{type:"date",name:"transaction_date",required:!0,value:t.transaction_date,onChange:r=>C(t.id,r.target.name,r.target.value)})]}),e("div",{className:"w-full",children:[a(i,{children:"Nominal"}),e("div",{className:"flex items-center justify-start gap-3",children:[a("div",{className:"min-w-32",children:a(j,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:(r,d)=>O(parseInt(r),d,t.id),value:t.nominal,placeholder:"Inputkan angka tanpa sparator"})}),e("div",{className:"flex items-center justify-start gap-3",children:[a(na,{name:"dana_titipan",id:`dana_titipan_${t.id}`,checked:t.isActiveMember,onChange:r=>C(t.id,r.target.name,r.target.checked)}),a(i,{htmlFor:`dana_titipan_${t.id}`,className:"whitespace-nowrap",children:"Dana Titipan"})]}),a(h,{onClick:()=>B(t.id),type:"button",size:"iconsm",variant:"outline",children:a(sa,{className:"w-auto h-3"})})]})]})]},t.id))})]}),e("div",{className:"text-end",children:[n.tanggal_drop&&a(h,{type:"button",onClick:z,className:"mr-3",variant:"outline",children:"Add Angsuran"}),a(h,{children:"Submit"})]})]})]})]}),a("div",{className:"w-auto lg:w-3/4",children:e(la,{defaultValue:"pengajuan",className:"w-auto",children:[e(ra,{className:"grid w-full grid-cols-2",children:[a(S,{value:"pengajuan",children:"Riwayat Pinjaman"}),a(S,{value:"pinjaman",children:"Ringkasan Pinjaman"})]}),a(A,{value:"pengajuan",children:e(I,{children:[e(E,{children:[a(R,{children:"Riwayat Unit"}),a(T,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di satu unit"})]}),a(Y,{className:"space-y-2",children:a("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:a(M,{data:p==null?void 0:p.history_branch})})})]})}),a(A,{value:"pinjaman",children:e(I,{children:[e(E,{children:[a(R,{children:"Riwayat Lain"}),a(T,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di unit selain unit ini"})]}),a(Y,{className:"space-y-2",children:a("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:a(M,{data:p==null?void 0:p.history_lain})})})]})})]})})]})]})};export{La as default};
