import{G as J,r as d,d as N,j as a,e as X}from"./app-BlzqtPcr.js";import{I as c}from"./InputError-CSAqRzqB.js";import{L as Q}from"./Loading-BgtzZQRm.js";import{B as x}from"./button-CxAqOe60.js";import{I as i}from"./input-Cp1ac3Of.js";import{L as r}from"./label-Ch1J7txU.js";import{C as y}from"./index.esm-CSyHh15j.js";import{u as W,S as Z}from"./SelectComponent-DbA0Xyjm.js";import{A as aa}from"./AuthenticatedLayout-BDlQ-zQv.js";import{C as ea}from"./Checkbox-DHqGi0tz.js";import{T as sa,a as ta,b as q,c as D}from"./tabs-CdivAVYr.js";import{C as S,a as A,b as E,c as I,d as R}from"./card-Q0YIuMo0.js";import T from"./RiwayatPengajuan-DuxJ8pn6.js";import{S as na}from"./search-CvF_N_1z.js";import{X as ra}from"./x-BhZIvCWr.js";import"./index--VEq69Mu.js";import"./transition-HvzE_kEE.js";import"./index-D1AqnB3K.js";import"./utils-CytzSlOG.js";import"./index-pbZui0b7.js";import"./index-Z3qc6eJw.js";import"./Dropdown-Bz_T2-UK.js";import"./createLucideIcon-CdRUMvYc.js";import"./sweetalert2.esm.all-BwOSfbNo.js";import"./index-C4pjDXLy.js";import"./index-BFOAfDvG.js";import"./Combination-BV17w2Eu.js";import"./index-CPsinKjQ.js";import"./index-DTI-xL_R.js";import"./react-icons.esm-G9W-Qh2_.js";import"./SweetAlert-CBK5EkKy.js";import"./table-BO8EiDKL.js";import"./index-6fqLMh3A.js";import"./BadgeStatus-CylPdT_t.js";import"./badge-_W-24pnx.js";const Ba=()=>{const{optKelompok:Y}=W(),{data:s,setData:h,post:M,errors:m,processing:P,reset:k}=J({isActiveMember:!1,nik:"",request_date:"",tanggal_drop:"",no_kk:"",nama:"",alamat:"",kelompok:"",request_nominal:"",angsuran:[]}),[l,g]=d.useState([]);d.useEffect(()=>{g([])},[s.tanggal_drop]),d.useEffect(()=>{h("angsuran",l)},[l]);const L=()=>{const e=l.length>0?N(l[l.length-1].transaction_date).add(1,"week").format("YYYY-MM-DD"):s.tanggal_drop?N(s.tanggal_drop).add(1,"week").format("YYYY-MM-DD"):"";g([...l,{id:Date.now(),transaction_date:e}])},K=e=>{g(l.filter(t=>t.id!==e))},w=(e,t,n)=>{g(l.map(o=>o.id===e?{...o,[t]:n}:o))},z=(e,t,n)=>{g(l.map(o=>o.id===n?{...o,[t]:e}:o))},[j,B]=d.useState(""),[O,v]=d.useState(!1),[_,C]=d.useState(),[u,b]=d.useState([]),[U,V]=d.useState();d.useEffect(()=>{V(s.request_date),h(e=>({...e,tanggal_drop:s.request_date?N(s.request_date).add(1,"week").format("YYYY-MM-DD"):""}))},[s.request_date]);const F=(e,t)=>{h(t,e)},p=e=>{const{name:t,value:n}=e.target;h(t,n)},G=e=>{const{name:t,value:n}=e.target;B(n),b([])},H=async e=>{e.preventDefault(),k(),v(!0),C(),await X({method:"post",url:route("transaction.nasabah_buku_transaksi"),data:{nik:j}}).then(function({data:t}){v(!1),h(n=>({...n,nik:t.return_nik,isActiveMember:!!t.data})),t.data?b(t.data):b([])}).catch(function({response:t}){C(t.data.message),v(!1)})},$=e=>{e.preventDefault(),M(route("transaction.store_buku_transaksi_batch"),{onSuccess:()=>{k()}})},f=e=>{const t=e.target.getAttribute("data-value");h("request_nominal",t)};return a.jsxs(aa,{children:[a.jsx(Q,{show:O||P}),a.jsxs("div",{className:"flex flex-col w-full gap-3 lg:flex-row",children:[a.jsxs("div",{className:"w-auto",children:[a.jsxs("fieldset",{className:"w-full p-4 mb-3 border rounded-lg",children:[a.jsx("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Cari Nasabah"}),a.jsxs("form",{className:"w-full mb-3",onSubmit:H,children:[a.jsx(r,{optional:!0,children:"NIK"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(i,{type:"text",name:"nik",value:j,onChange:G,placeholder:"Cek NIK"}),a.jsxs(x,{className:"text-xs",size:"sm",children:[a.jsx(na,{className:"w-auto h-4 mr-1"}),"Cari"]})]}),_&&a.jsx(c,{message:_,className:"mt-1"}),a.jsxs("div",{className:`font-semibold mt-1 ${j.length==16?"text-green-500":"text-red-500"}`,children:[j.length," Digit"]})]})]}),j&&s.nik==j&&a.jsxs("fieldset",{className:"w-full p-4 border rounded-lg",children:[a.jsx("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Detail Pinjaman"}),a.jsxs("form",{className:"w-full mb-3",onSubmit:$,children:[a.jsxs("div",{className:"flex gap-5",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Tanggal Pengajuan"}),a.jsx(i,{type:"date",name:"request_date",required:!0,value:s.request_date,onChange:p}),a.jsx(c,{value:m.request_date})]}),a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Tanggal Drop"}),a.jsx(i,{type:"date",name:"tanggal_drop",min:U,required:!0,value:s.tanggal_drop,onChange:p}),a.jsx(c,{value:m.tanggal_drop})]})]}),s.request_date&&s.request_date==s.tanggal_drop?a.jsx("div",{className:"w-full mb-3 font-semibold text-red-500",children:"DROP BARU"}):a.jsx("div",{className:"w-full mb-3 font-semibold text-red-500",children:"PENGAJUAN DROP"}),a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{optional:!0,children:"NIK"}),a.jsx(i,{type:"text",name:"nik",value:s.nik,disabled:!0,onChange:p}),a.jsx(c,{value:m.nik})]}),s.isActiveMember?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Nama"}),a.jsx(i,{type:"text",disabled:!0,value:u.nama??""})]}),a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Alamat"}),a.jsx(i,{type:"text",disabled:!0,value:u.alamat??""})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{optional:!0,children:"NO KK"}),a.jsx(i,{type:"text",name:"no_kk",value:s.no_kk,onChange:p}),a.jsx(c,{value:m.no_kk})]}),a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Nama"}),a.jsx(i,{type:"text",name:"nama",value:s.nama,onChange:p,required:!0}),a.jsx(c,{value:m.nama})]}),a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Alamat"}),a.jsx(i,{type:"text",name:"alamat",value:s.alamat,onChange:p,required:!0}),a.jsx(c,{value:m.alamat})]})]}),a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Kelompok"}),a.jsx(Z,{value:s.kelompok,options:Y,name:"kelompok",nullvalue:!0,onChange:p,required:!0}),a.jsx(c,{value:m.kelompok})]}),a.jsxs("div",{className:"w-full mb-3",children:[a.jsx(r,{children:"Nominal Pinjaman"}),a.jsx(y,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-xs h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"request_nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:F,value:s.request_nominal,placeholder:"Inputkan angka tanpa sparator"}),a.jsx(c,{value:m.request_nominal})]}),a.jsxs("div",{className:"flex flex-wrap w-full gap-2 mb-3",children:[a.jsx(x,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":"500000",children:"500.000"}),a.jsx(x,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":"700000",children:"700.000"}),a.jsx(x,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":"1000000",children:"1.000.000"}),a.jsx(x,{type:"button",variant:"destructive",size:"xs",onClick:f,"data-value":"0",children:"reset"})]})]}),a.jsx("div",{className:"flex-1",children:l.map((e,t)=>a.jsxs("div",{className:"flex gap-3 mb-3",children:[a.jsxs("div",{className:"w-full",children:[a.jsx(r,{children:"Tanggal Storting"}),a.jsx(i,{type:"date",name:"transaction_date",required:!0,value:e.transaction_date,onChange:n=>w(e.id,n.target.name,n.target.value)})]}),a.jsxs("div",{className:"w-full",children:[a.jsx(r,{children:"Nominal"}),a.jsxs("div",{className:"flex items-center justify-start gap-3",children:[a.jsx("div",{className:"min-w-32",children:a.jsx(y,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-xs h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:(n,o)=>z(parseInt(n),o,e.id),value:e.nominal,placeholder:"Inputkan angka tanpa sparator"})}),a.jsxs("div",{className:"flex items-center justify-start gap-3",children:[a.jsx(ea,{name:"dana_titipan",id:`dana_titipan_${e.id}`,checked:e.isActiveMember,onChange:n=>w(e.id,n.target.name,n.target.checked)}),a.jsx(r,{htmlFor:`dana_titipan_${e.id}`,className:"whitespace-nowrap",children:"Dana Titipan"})]}),a.jsx(x,{onClick:()=>K(e.id),type:"button",size:"iconsm",variant:"outline",children:a.jsx(ra,{className:"w-auto h-3"})})]})]})]},e.id))})]}),a.jsxs("div",{className:"text-end",children:[s.tanggal_drop&&a.jsx(x,{type:"button",onClick:L,className:"mr-3",variant:"outline",children:"Add Angsuran"}),a.jsx(x,{children:"Submit"})]})]})]})]}),a.jsx("div",{className:"w-auto lg:w-3/4",children:a.jsxs(sa,{defaultValue:"pengajuan",className:"w-auto",children:[a.jsxs(ta,{className:"grid w-full grid-cols-2",children:[a.jsx(q,{value:"pengajuan",children:"Riwayat Pinjaman"}),a.jsx(q,{value:"pinjaman",children:"Ringkasan Pinjaman"})]}),a.jsx(D,{value:"pengajuan",children:a.jsxs(S,{children:[a.jsxs(A,{children:[a.jsx(E,{children:"Riwayat Unit"}),a.jsx(I,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di satu unit"})]}),a.jsx(R,{className:"space-y-2",children:a.jsx("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:a.jsx(T,{data:u==null?void 0:u.history_branch})})})]})}),a.jsx(D,{value:"pinjaman",children:a.jsxs(S,{children:[a.jsxs(A,{children:[a.jsx(E,{children:"Riwayat Lain"}),a.jsx(I,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di unit selain unit ini"})]}),a.jsx(R,{className:"space-y-2",children:a.jsx("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:a.jsx(T,{data:u==null?void 0:u.history_lain})})})]})})]})})]})]})};export{Ba as default};
