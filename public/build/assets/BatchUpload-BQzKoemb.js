import{X as J,r as i,G as Q,d as k,j as e,e as W}from"./app-Bhivlch7.js";import{I as c}from"./InputError-Cv7B-ZZO.js";import{L as Z}from"./Loading-t8FMcHgb.js";import{B as x}from"./button-WrdTxjeE.js";import{I as o}from"./input-C1MgnBgH.js";import{L as r}from"./label-f9exgD1p.js";import{C as q}from"./index.esm-BWpq93dO.js";import{u as ee,S as ae}from"./SelectComponent-BxXslFOi.js";import{A as se}from"./AuthenticatedLayout-PufjrBR2.js";import{C as te}from"./Checkbox-DQkO9nFr.js";import{T as ne,a as re,b as D,c as S}from"./tabs-kppXGzUX.js";import{C as A,a as E,b as I,c as R,d as T}from"./card-BtfmrOHR.js";import Y from"./RiwayatPengajuan-DI3KLcwc.js";import{S as le}from"./search-FKtGtsTi.js";import{X as ie}from"./x-VYlTjHTD.js";import"./index-BXTG1-HC.js";import"./transition-BaHuss9e.js";import"./index-BpvjGo4Q.js";import"./utils-CytzSlOG.js";import"./index-CU-RFAUE.js";import"./index-CPeVGlOF.js";import"./Dropdown-DBNjp1PC.js";import"./createLucideIcon-2do_5kKh.js";import"./sweetalert2.esm.all-BbRIsSe6.js";import"./index-RiEVygcu.js";import"./index-8-do7Nv1.js";import"./Combination-DDbaWZJo.js";import"./index-Bbv6vY0H.js";import"./index-BC73xeDO.js";import"./react-icons.esm-DdkpgTZ2.js";import"./SweetAlert-DdGhkahH.js";import"./table-C1HsK9wX.js";import"./index-rhVWMN1R.js";import"./BadgeStatus-DQedcSvR.js";import"./badge-BUfAq5qS.js";const Oe=()=>{const{printUrl:v}=J().props;i.useEffect(()=>{v.url&&window.open(v.url,"_blank")},[v.timestamp]);const{optKelompok:M}=ee(),{data:s,setData:h,post:P,errors:m,processing:L,reset:w}=Q({isActiveMember:!1,nik:"",request_date:"",tanggal_drop:"",no_kk:"",nama:"",alamat:"",kelompok:"",request_nominal:"",angsuran:[]}),[l,g]=i.useState([]);i.useEffect(()=>{g([])},[s.tanggal_drop]),i.useEffect(()=>{h("angsuran",l)},[l]);const K=()=>{const a=l.length>0?k(l[l.length-1].transaction_date).add(1,"week").format("YYYY-MM-DD"):s.tanggal_drop?k(s.tanggal_drop).add(1,"week").format("YYYY-MM-DD"):"";g([...l,{id:Date.now(),transaction_date:a}])},z=a=>{g(l.filter(t=>t.id!==a))},_=(a,t,n)=>{g(l.map(d=>d.id===a?{...d,[t]:n}:d))},U=(a,t,n)=>{g(l.map(d=>d.id===n?{...d,[t]:a}:d))},[j,B]=i.useState(""),[O,b]=i.useState(!1),[C,y]=i.useState(),[u,N]=i.useState([]),[V,$]=i.useState();i.useEffect(()=>{$(s.request_date),h(a=>({...a,tanggal_drop:s.request_date?k(s.request_date).add(1,"week").format("YYYY-MM-DD"):""}))},[s.request_date]);const F=(a,t)=>{h(t,a)},p=a=>{const{name:t,value:n}=a.target;h(t,n)},G=a=>{const{name:t,value:n}=a.target;B(n),N([])},H=async a=>{a.preventDefault(),w(),b(!0),y(),await W({method:"post",url:route("transaction.nasabah_buku_transaksi"),data:{nik:j}}).then(function({data:t}){b(!1),h(n=>({...n,nik:t.return_nik,isActiveMember:!!t.data})),t.data?N(t.data):N([])}).catch(function({response:t}){y(t.data.message),b(!1)})},X=a=>{a.preventDefault(),P(route("transaction.store_buku_transaksi_batch"),{onSuccess:()=>{w()}})},f=a=>{const t=a.target.getAttribute("data-value");h("request_nominal",t)};return e.jsxs(se,{children:[e.jsx(Z,{show:O||L}),e.jsxs("div",{className:"flex flex-col w-full gap-3 lg:flex-row",children:[e.jsxs("div",{className:"w-auto",children:[e.jsxs("fieldset",{className:"w-full p-4 mb-3 border rounded-lg",children:[e.jsx("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Cari Nasabah"}),e.jsxs("form",{className:"w-full mb-3",onSubmit:H,children:[e.jsx(r,{optional:!0,children:"NIK"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{type:"text",name:"nik",value:j,onChange:G,placeholder:"Cek NIK"}),e.jsxs(x,{className:"text-xs",size:"sm",children:[e.jsx(le,{className:"w-auto h-4 mr-1"}),"Cari"]})]}),C&&e.jsx(c,{message:C,className:"mt-1"}),e.jsxs("div",{className:`font-semibold mt-1 ${j.length==16?"text-green-500":"text-red-500"}`,children:[j.length," Digit"]})]})]}),j&&s.nik==j&&e.jsxs("fieldset",{className:"w-full p-4 border rounded-lg",children:[e.jsx("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Detail Pinjaman"}),e.jsxs("form",{className:"w-full mb-3",onSubmit:X,children:[e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Tanggal Pengajuan"}),e.jsx(o,{type:"date",name:"request_date",required:!0,value:s.request_date,onChange:p}),e.jsx(c,{value:m.request_date})]}),e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Tanggal Drop"}),e.jsx(o,{type:"date",name:"tanggal_drop",min:V,required:!0,value:s.tanggal_drop,onChange:p}),e.jsx(c,{value:m.tanggal_drop})]})]}),s.request_date&&s.request_date==s.tanggal_drop?e.jsx("div",{className:"w-full mb-3 font-semibold text-red-500",children:"DROP BARU"}):e.jsx("div",{className:"w-full mb-3 font-semibold text-red-500",children:"PENGAJUAN DROP"}),e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{optional:!0,children:"NIK"}),e.jsx(o,{type:"text",name:"nik",value:s.nik,disabled:!0,onChange:p}),e.jsx(c,{value:m.nik})]}),s.isActiveMember?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Nama"}),e.jsx(o,{type:"text",disabled:!0,value:u.nama??""})]}),e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Alamat"}),e.jsx(o,{type:"text",disabled:!0,value:u.alamat??""})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{optional:!0,children:"NO KK"}),e.jsx(o,{type:"text",name:"no_kk",value:s.no_kk,onChange:p}),e.jsx(c,{value:m.no_kk})]}),e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Nama"}),e.jsx(o,{type:"text",name:"nama",value:s.nama,onChange:p,required:!0}),e.jsx(c,{value:m.nama})]}),e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Alamat"}),e.jsx(o,{type:"text",name:"alamat",value:s.alamat,onChange:p,required:!0}),e.jsx(c,{value:m.alamat})]})]}),e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Kelompok"}),e.jsx(ae,{value:s.kelompok,options:M,name:"kelompok",nullvalue:!0,onChange:p,required:!0}),e.jsx(c,{value:m.kelompok})]}),e.jsxs("div",{className:"w-full mb-3",children:[e.jsx(r,{children:"Nominal Pinjaman"}),e.jsx(q,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-xs h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"request_nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:F,value:s.request_nominal,placeholder:"Inputkan angka tanpa sparator"}),e.jsx(c,{value:m.request_nominal})]}),e.jsxs("div",{className:"flex flex-wrap w-full gap-2 mb-3",children:[e.jsx(x,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":"500000",children:"500.000"}),e.jsx(x,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":"700000",children:"700.000"}),e.jsx(x,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":"1000000",children:"1.000.000"}),e.jsx(x,{type:"button",variant:"destructive",size:"xs",onClick:f,"data-value":"0",children:"reset"})]})]}),e.jsx("div",{className:"flex-1",children:l.map((a,t)=>e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(r,{children:"Tanggal Storting"}),e.jsx(o,{type:"date",name:"transaction_date",required:!0,value:a.transaction_date,onChange:n=>_(a.id,n.target.name,n.target.value)})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(r,{children:"Nominal"}),e.jsxs("div",{className:"flex items-center justify-start gap-3",children:[e.jsx("div",{className:"min-w-32",children:e.jsx(q,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-xs h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:(n,d)=>U(parseInt(n),d,a.id),value:a.nominal,placeholder:"Inputkan angka tanpa sparator"})}),e.jsxs("div",{className:"flex items-center justify-start gap-3",children:[e.jsx(te,{name:"dana_titipan",id:`dana_titipan_${a.id}`,checked:a.isActiveMember,onChange:n=>_(a.id,n.target.name,n.target.checked)}),e.jsx(r,{htmlFor:`dana_titipan_${a.id}`,className:"whitespace-nowrap",children:"Dana Titipan"})]}),e.jsx(x,{onClick:()=>z(a.id),type:"button",size:"iconsm",variant:"outline",children:e.jsx(ie,{className:"w-auto h-3"})})]})]})]},a.id))})]}),e.jsxs("div",{className:"text-end",children:[s.tanggal_drop&&e.jsx(x,{type:"button",onClick:K,className:"mr-3",variant:"outline",children:"Add Angsuran"}),e.jsx(x,{children:"Submit"})]})]})]})]}),e.jsx("div",{className:"w-auto lg:w-3/4",children:e.jsxs(ne,{defaultValue:"pengajuan",className:"w-auto",children:[e.jsxs(re,{className:"grid w-full grid-cols-2",children:[e.jsx(D,{value:"pengajuan",children:"Riwayat Pinjaman"}),e.jsx(D,{value:"pinjaman",children:"Ringkasan Pinjaman"})]}),e.jsx(S,{value:"pengajuan",children:e.jsxs(A,{children:[e.jsxs(E,{children:[e.jsx(I,{children:"Riwayat Unit"}),e.jsx(R,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di satu unit"})]}),e.jsx(T,{className:"space-y-2",children:e.jsx("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:e.jsx(Y,{data:u==null?void 0:u.history_branch})})})]})}),e.jsx(S,{value:"pinjaman",children:e.jsxs(A,{children:[e.jsxs(E,{children:[e.jsx(I,{children:"Riwayat Lain"}),e.jsx(R,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di unit selain unit ini"})]}),e.jsx(T,{className:"space-y-2",children:e.jsx("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:e.jsx(Y,{data:u==null?void 0:u.history_lain})})})]})})]})})]})]})};export{Oe as default};
