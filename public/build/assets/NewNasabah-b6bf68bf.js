import{W as V,r as c,c as F,j as a,a as e,F as w,f as G}from"./app-d60d8e6f.js";import{I as i}from"./InputError-9e62b7ef.js";import{L as H}from"./Loading-b600f68f.js";import{B as h}from"./button-b2d54c72.js";import{C,a as y,b as _,c as q,d as j}from"./card-26ffa4d9.js";import{T as J,a as W,b as S,c as D}from"./tabs-c9757a95.js";import{I as s}from"./input-910452ec.js";import{L as r}from"./label-960bb0a7.js";import{C as $}from"./index.esm-dd475e72.js";import{u as Q,S as X}from"./SelectComponent-541da426.js";import A from"./RiwayatPengajuan-a8e32ef6.js";import{S as Z}from"./search-ab6dafe8.js";import"./transition-f7a4344e.js";import"./utils-36e2ef84.js";import"./index-ae48cc8b.js";import"./index-fe2777ed.js";import"./index-e0dccabb.js";import"./index-6c9506c0.js";import"./FormatNumbering-f8b9ef63.js";import"./react-number-format.es-303a094c.js";import"./index-8c87fbb9.js";import"./BadgeStatus-52b56ba4.js";import"./badge-f83a80f7.js";import"./createLucideIcon-2f260953.js";const ye=({onClosed:I})=>{const{optKelompok:P}=Q(),{data:t,setData:p,post:R,errors:o,processing:T,reset:v}=V({isActiveMember:!1,nik:""}),[m,L]=c.useState(""),[K,b]=c.useState(!1),[N,k]=c.useState(),[d,x]=c.useState([]),[M,z]=c.useState();c.useEffect(()=>{z(t.request_date),p(l=>({...l,tanggal_drop:F(t.request_date).add(1,"week").format("YYYY-MM-DD")}))},[t.request_date]);const E=(l,n)=>{p(n,l)},u=l=>{const{name:n,value:f}=l.target;p(n,f)},O=l=>{const{name:n,value:f}=l.target;L(f)},Y=async l=>{l.preventDefault(),v(),b(!0),k(),await G({method:"post",url:route("transaction.nasabah_buku_transaksi"),data:{nik:m}}).then(function({data:n}){b(!1),p(f=>({...f,nik:n.return_nik,isActiveMember:!!n.data})),n.data?(x(n.data),console.log(n.data)):x([])}).catch(function({response:n}){k(n.data.message),b(!1)})},B=l=>{I(),v()},U=l=>{l.preventDefault(),R(route("transaction.store_buku_transaksi"),{onSuccess:()=>{B()},replace:!0})},g=l=>{const n=l.target.getAttribute("data-value");p("request_nominal",n)};return a("div",{className:"flex flex-col w-full gap-3 lg:flex-row",children:[e(H,{show:K||T}),a("div",{className:"w-auto",children:[a("fieldset",{className:"w-full p-4 mb-3 border rounded-lg",children:[e("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Cari Nasabah"}),a("form",{className:"w-full mb-3",onSubmit:Y,children:[e(r,{optional:!0,children:"NIK"}),a("div",{className:"flex items-center gap-3",children:[e(s,{type:"text",name:"nik",value:m,onChange:O,placeholder:"Cek NIK"}),a(h,{className:"text-xs",size:"sm",children:[e(Z,{className:"w-auto h-4 mr-1"}),"Cari"]})]}),N&&e(i,{message:N,className:"mt-1"}),a("div",{className:`font-semibold mt-1 ${m.length==16?"text-green-500":"text-red-500"}`,children:[m.length," Digit"]})]})]}),m&&t.nik==m&&a("fieldset",{className:"w-full p-4 border rounded-lg",children:[e("legend",{className:"px-1 -ml-1 text-sm font-medium",children:"Detail Pinjaman"}),a("form",{className:"w-full mb-3",onSubmit:U,children:[a("div",{className:"flex gap-3",children:[a("div",{className:"w-full mb-3",children:[e(r,{children:"Tanggal Pengajuan"}),e(s,{type:"date",name:"request_date",required:!0,value:t.request_date,onChange:u}),e(i,{value:o.request_date})]}),a("div",{className:"w-full mb-3",children:[e(r,{children:"Tanggal Drop"}),e(s,{type:"date",name:"tanggal_drop",min:M,required:!0,value:t.tanggal_drop,onChange:u}),e(i,{value:o.tanggal_drop})]})]}),t.request_date&&t.request_date==t.tanggal_drop?e("div",{className:"w-full mb-3 font-semibold text-red-500",children:"DROP BARU"}):e("div",{className:"w-full mb-3 font-semibold text-red-500",children:"PENGAJUAN DROP"}),a("div",{className:"w-full mb-3",children:[e(r,{optional:!0,children:"NIK"}),e(s,{type:"text",name:"nik",value:t.nik,disabled:!0,onChange:u}),e(i,{value:o.nik})]}),t.isActiveMember?a(w,{children:[a("div",{className:"w-full mb-3",children:[e(r,{children:"Nama"}),e(s,{type:"text",disabled:!0,value:d.nama??""})]}),a("div",{className:"w-full mb-3",children:[e(r,{children:"Alamat"}),e(s,{type:"text",disabled:!0,value:d.alamat??""})]})]}):a(w,{children:[a("div",{className:"w-full mb-3",children:[e(r,{optional:!0,children:"NO KK"}),e(s,{type:"text",name:"no_kk",value:t.no_kk,onChange:u}),e(i,{value:o.no_kk})]}),a("div",{className:"w-full mb-3",children:[e(r,{children:"Nama"}),e(s,{type:"text",name:"nama",value:t.nama,onChange:u,required:!0}),e(i,{value:o.nama})]}),a("div",{className:"w-full mb-3",children:[e(r,{children:"Alamat"}),e(s,{type:"text",name:"alamat",value:t.alamat,onChange:u,required:!0}),e(i,{value:o.alamat})]})]}),a("div",{className:"w-full mb-3",children:[e(r,{children:"Kelompok"}),e(X,{value:t.kelompok,options:P,name:"kelompok",nullvalue:!0,onChange:u,required:!0}),e(i,{value:o.kelompok})]}),a("div",{className:"w-full mb-3",children:[e(r,{children:"Nominal Pinjaman"}),e($,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"request_nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:E,value:t.request_nominal,placeholder:"Inputkan angka tanpa sparator"}),e(i,{value:o.request_nominal})]}),a("div",{className:"flex flex-wrap w-full gap-2 mb-3",children:[e(h,{type:"button",variant:"outline",size:"xs",onClick:g,"data-value":"500000",children:"500.000"}),e(h,{type:"button",variant:"outline",size:"xs",onClick:g,"data-value":"700000",children:"700.000"}),e(h,{type:"button",variant:"outline",size:"xs",onClick:g,"data-value":"1000000",children:"1.000.000"}),e(h,{type:"button",variant:"destructive",size:"xs",onClick:g,"data-value":"0",children:"reset"})]}),e("div",{className:"text-end",children:e(h,{children:"Submit"})})]})]})]}),e("div",{className:"w-auto lg:w-3/4",children:a(J,{defaultValue:"pengajuan",className:"w-auto",children:[a(W,{className:"grid w-full grid-cols-2",children:[e(S,{value:"pengajuan",children:"Riwayat Pinjaman"}),e(S,{value:"pinjaman",children:"Ringkasan Pinjaman"})]}),e(D,{value:"pengajuan",children:a(C,{children:[a(y,{children:[e(_,{children:"Riwayat Unit"}),e(q,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di satu unit"})]}),e(j,{className:"space-y-2",children:e("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:e(A,{data:d==null?void 0:d.history_branch})})})]})}),e(D,{value:"pinjaman",children:a(C,{children:[a(y,{children:[e(_,{children:"Riwayat Lain"}),e(q,{children:"Riwayat Pengajuan Nasabah sesuai dengan nik di unit selain unit ini"})]}),e(j,{className:"space-y-2",children:e("div",{className:"h-[50vh] border rounded-lg overflow-auto scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin",children:e(A,{data:d==null?void 0:d.history_lain})})})]})})]})})]})};export{ye as default};
