import{r as d,j as h,a as e,d as K,R as L}from"./app-894fb644.js";import{T as P,a as Q,b as S,c as k,d as U,e as l,F as n,f as V}from"./FormatNumbering-1c98251f.js";import"./button-9da4f797.js";import X from"./Action-bdf6e508.js";import Z from"./ApprovalAkhir-908ff7b6.js";import"./utils-46f1eee5.js";import"./react-number-format.es-fde60237.js";import"./index-f96983da.js";import"./dialog-a5dfac83.js";import"./index-b8da1699.js";import"./react-icons.esm-bacaa70f.js";import"./index-1ee04d40.js";import"./card-e75d9471.js";import"./StatusPinjaman-b796a8cf.js";import"./badge-9ff1b0cb.js";import"./BayarAngsuran-b302214e.js";import"./label-b28b47d1.js";import"./index-b4346aa2.js";import"./input-0ac0cdb0.js";import"./index.esm-481f5ba8.js";import"./Checkbox-767b89a8.js";import"./Loading-b2556a0b.js";import"./transition-dd2a41ee.js";import"./JenisNasabah-c377cb81.js";import"./InputError-aa33e7fd.js";import"./InputLabel-4b35f36f.js";import"./PrimaryButton-28ebe16b.js";import"./SelectList-b22ee93b.js";import"./DeleteAngsuran-645b2123.js";import"./TextInput-336aec83.js";import"./DeleteLoan-5ffcea88.js";const Be=({dateOfWeek:x,datas:w,sirkulasi:y})=>{const[i,D]=d.useState([]),[g,T]=d.useState(0),[I,j]=d.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});d.useEffect(()=>{if(w){const t=w.map((r,b)=>(()=>{var A;const u={},N=(a=>Array.isArray(a)?a.length===0?{max:{},min:{}}:a.length===1?{max:{},min:a[0]}:a.reduce((s,o)=>{const c=new Date(o.date),G=new Date(s.min.date),J=new Date(s.max.date);return c<G&&(s.min=o),c>J&&(s.max=o),s},{max:a[0],min:a[0]}):{max:{},min:{}})(y);T(((A=N.max)==null?void 0:A.amount)??0);const Y=a=>{var s;switch(a.type){case"ml":return((s=N.min)==null?void 0:s.ml_amount)??0;default:return a.data.reduce((o,c)=>o+c.saldo_sebelumnya,0)}},z=a=>{var s;switch(a.type){case"ml":return((s=N.min)==null?void 0:s.ml_amount)??0;case"mb":return a.data.reduce((o,c)=>o+c.saldo_sebelumnya,0);case"cm":return a.data.reduce((o,c)=>o+c.saldo_sebelumnya,0);default:return a.data.reduce((o,c)=>o+c.saldo_sebelumnya,0)}},v=Y(r),q=z(r);x.forEach(a=>{u[a]=0});let f=0;return r.data.forEach(a=>{x.forEach(s=>{a.instalment[s]!==void 0&&(f+=a.instalment[s],u[s]+=a.instalment[s])})}),j(a=>({...a,[r.type]:{sirkulasi:v,angsuran:f,saldo:v-f}})),{key:r.month,instalment:{...u},sirkulasi:v,sirkulasii:q,totalInstalment:f,sirkulasiAfter:v-f}})());D(t)}},[w]);const B=(t,r)=>t.reduce((p,u)=>p+parseInt(u.instalment[r]??0),0),m=(t,r)=>t.reduce((p,u)=>p+parseInt(u[r]??0),0),[M,_]=d.useState(null),[C,E]=d.useState(!1),F=()=>{E(!1),_(null)},[R,H]=d.useState(!1),O=()=>{H(!1)};return h("div",{className:"relative overflow-auto h-[70vh] lg:h-[85vh] scrollbar-thin",children:[h(P,{className:"text-xs rounded-lg",children:[e(Q,{className:"sticky top-0 left-0 z-10",children:h(S,{className:"bg-gray-200",children:[e(k,{className:"text-center",children:"Bulan"}),e(k,{className:"text-center",children:"Sirkulasi"}),e(k,{className:"text-center",children:"Sirkulasi2"}),x.map((t,r)=>e(k,{className:"text-center whitespace-nowrap",children:K(t).format("DD-MM-YY")},r)),e(k,{className:"text-center",children:"Angsuran"}),e(k,{className:"text-center",children:"Saldo"})]})}),e(U,{children:i?i.map((t,r)=>e(L.Fragment,{children:h(S,{children:[e(l,{children:t.key}),e(l,{children:e(n,{value:t.sirkulasi})}),e(l,{children:e(n,{value:t.sirkulasii})}),x.map((b,p)=>e(l,{className:"text-center whitespace-normal",children:e(n,{value:t.instalment[b]})},p)),e(l,{children:e(n,{value:t.totalInstalment})}),e(l,{children:e(n,{value:t.sirkulasiAfter})})]})},r)):e(S,{children:e(l,{children:"a"})})}),h(V,{children:[h(S,{children:[e(l,{rowSpan:2,className:"text-center",children:"Total"}),e(l,{rowSpan:2,className:"text-center",children:e(n,{value:m(i,"sirkulasi")})}),e(l,{rowSpan:2,className:"text-center",children:e(n,{value:m(i,"sirkulasii")})}),x.map((t,r)=>e(l,{rowSpan:2,className:"text-center",children:e(n,{value:B(i,t)})},r)),e(l,{rowSpan:2,className:"text-center",children:e(n,{value:m(i,"totalInstalment")})}),m(i,"sirkulasiAfter")==g?e(l,{rowSpan:2,className:"text-center",children:e(n,{value:m(i,"sirkulasiAfter")})}):e(l,{className:"text-center",children:e(n,{value:m(i,"sirkulasiAfter")})})]}),e(S,{children:g&&m(i,"sirkulasiAfter")!=g?e(l,{className:"text-center bg-red-500",children:e(n,{value:g})}):""})]})]}),e(Z,{show:R,onClosed:O,datas:I}),e(X,{datas:i,show:C,onClosed:F,triggeredId:M})]})};export{Be as default};
