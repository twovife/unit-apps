import{r as h,j as u,a as e,d as H,R as Y}from"./app-0f2e4e76.js";import{T as z,a as _,b as x,c as f,d as q,e as s,F as i,f as G}from"./FormatNumbering-f8d78f10.js";import"./button-f038f828.js";import J from"./Action-82a8334c.js";import"./utils-46f1eee5.js";import"./react-number-format.es-65164a41.js";import"./index-f96983da.js";import"./dialog-10cb4af5.js";import"./index-4bd30249.js";import"./react-icons.esm-b1cf6d50.js";import"./index-10dd0e77.js";import"./card-9cc78772.js";import"./badge-2ab03836.js";import"./BayarAngsuran-0f308a13.js";import"./label-3cff1259.js";import"./index-9ff45cbe.js";import"./input-5a15ee5e.js";import"./index.esm-05cb97c8.js";import"./Checkbox-91fa6892.js";import"./Loading-486cdcc7.js";import"./transition-00a3a3cd.js";import"./JenisNasabah-2818722d.js";import"./InputError-32ab3ab5.js";import"./InputLabel-ef8fbb0e.js";import"./PrimaryButton-f4e272ea.js";import"./SelectList-9a48c957.js";import"./DeleteAngsuran-8b8b7520.js";import"./TextInput-874e2ed3.js";import"./DeleteLoan-45a088b4.js";const be=({dateOfWeek:d,datas:N,sirkulasi:A})=>{const[l,T]=h.useState([]),[g,w]=h.useState(0);h.useEffect(()=>{if(N){const t=N.map((r,S)=>(()=>{var v;const c={},F=(a=>Array.isArray(a)?a.length===0?{max:{},min:{}}:a.length===1?{max:{},min:a[0]}:a.reduce((n,p)=>{const D=new Date(p.date),C=new Date(n.min.date),R=new Date(n.max.date);return D<C&&(n.min=p),D>R&&(n.max=p),n},{max:a[0],min:a[0]}):{max:{},min:{}})(A);w(((v=F.max)==null?void 0:v.amount)??0);const k=(a=>a.data.reduce((n,p)=>n+p.saldo_sebelumnya,0))(r);d.forEach(a=>{c[a]=0});let b=0;return r.data.forEach(a=>{d.forEach(n=>{a.instalment[n]!==void 0&&(b+=a.instalment[n],c[n]+=a.instalment[n])})}),{key:r.month,instalment:{...c},sirkulasi:k,totalInstalment:b,sirkulasiAfter:k-b}})());T(t)}},[N]);const y=(t,r)=>t.reduce((m,c)=>m+parseInt(c.instalment[r]??0),0),o=(t,r)=>t.reduce((m,c)=>m+parseInt(c[r]??0),0),[I,j]=h.useState(null),[M,B]=h.useState(!1),E=()=>{B(!1),j(null)};return u("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[u(z,{className:"text-xs rounded-lg",children:[e(_,{className:"sticky top-0 left-0 z-10",children:u(x,{className:"bg-gray-200",children:[e(f,{className:"text-center",children:"Bulan"}),e(f,{className:"text-center",children:"Sirkulasi"}),d.map((t,r)=>e(f,{className:"text-center",children:H(t).format("DD-MM-YY")},r)),e(f,{className:"text-center",children:"Angsuran"}),e(f,{className:"text-center",children:"Saldo"})]})}),e(q,{children:l?l.map((t,r)=>e(Y.Fragment,{children:u(x,{children:[e(s,{children:t.key}),e(s,{children:e(i,{value:t.sirkulasi})}),d.map((S,m)=>e(s,{className:"text-center",children:e(i,{value:t.instalment[S]})},m)),e(s,{children:e(i,{value:t.totalInstalment})}),e(s,{children:e(i,{value:t.sirkulasiAfter})})]})},r)):e(x,{children:e(s,{children:"a"})})}),u(G,{children:[u(x,{children:[e(s,{rowSpan:2,className:"text-center",children:"Total"}),e(s,{rowSpan:2,className:"text-center",children:e(i,{value:o(l,"sirkulasi")})}),d.map((t,r)=>e(s,{rowSpan:2,className:"text-center",children:e(i,{value:y(l,t)})},r)),e(s,{rowSpan:2,className:"text-center",children:e(i,{value:o(l,"totalInstalment")})}),o(l,"sirkulasiAfter")==g?e(s,{rowSpan:2,className:"text-center",children:e(i,{value:o(l,"sirkulasiAfter")})}):e(s,{className:"text-center",children:e(i,{value:o(l,"sirkulasiAfter")})})]}),e(x,{children:g&&o(l,"sirkulasiAfter")!=g?e(s,{className:"text-center bg-red-500",children:e(i,{value:g})}):""})]})]}),e(J,{datas:l,show:M,onClosed:E,triggeredId:I})]})};export{be as default};
