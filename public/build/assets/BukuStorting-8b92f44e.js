import{r as x,j as d,a as e,d as R,R as H}from"./app-c6606e33.js";import{T as Y,a as z,b as f,c as g,d as q,e as n,F as i,f as G}from"./FormatNumbering-1e3e68fe.js";import"./button-fe11bc13.js";import J from"./Action-a45aa13b.js";import"./utils-36e2ef84.js";import"./react-number-format.es-e5555c85.js";import"./dialog-70bcb265.js";import"./index-39150321.js";import"./react-icons.esm-95aa6c4b.js";import"./index-11064b03.js";import"./card-de3f5dc5.js";import"./badge-c5969573.js";import"./BayarAngsuran-4c9bc2a6.js";import"./label-b4f6d4a1.js";import"./index-cc196a4b.js";import"./input-1b9098cf.js";import"./index.esm-93a00f8b.js";import"./Checkbox-d0f11273.js";import"./Loading-574070e9.js";import"./transition-e36bd37b.js";import"./JenisNasabah-c565485e.js";import"./InputError-061b44de.js";import"./InputLabel-09fe496f.js";import"./PrimaryButton-498da0f5.js";import"./SelectList-29952cb1.js";import"./DeleteAngsuran-2b14687d.js";import"./TextInput-8e8a655c.js";const Se=({dateOfWeek:p,datas:k,sirkulasi:y})=>{const[l,I]=x.useState([]),[S,j]=x.useState(0);x.useEffect(()=>{if(k){const a=k.map((r,b)=>(()=>{var T;const c={},N=(t=>Array.isArray(t)?t.length===0?{max:{},min:{}}:t.length===1?{max:{},min:t[0]}:t.reduce((s,u)=>{const h=new Date(u.date),D=new Date(s.min.date),w=new Date(s.max.date);return h<D&&(s.min=u),h>w&&(s.max=u),s},{max:t[0],min:t[0]}):{max:{},min:{}})(y);j(((T=N.max)==null?void 0:T.amount)??0);const A=(t=>{var s,u,h;switch(t.type){case"ml":return((s=N.min)==null?void 0:s.ml_amount)??0;case"mb":return((u=N.min)==null?void 0:u.mb_amount)??0;case"cm":return((h=N.min)==null?void 0:h.cm_amount)??0;default:return t.data.reduce((D,w)=>D+w.saldo_sebelumnya,0)}})(r);p.forEach(t=>{c[t]=0});let v=0;return r.data.forEach(t=>{p.forEach(s=>{t.instalment[s]!==void 0&&(v+=t.instalment[s],c[s]+=t.instalment[s])})}),{key:r.month,instalment:{...c},sirkulasi:A,totalInstalment:v,sirkulasiAfter:A-v}})());I(a)}},[k]);const M=(a,r)=>a.reduce((o,c)=>o+parseInt(c.instalment[r]??0),0),m=(a,r)=>a.reduce((o,c)=>o+parseInt(c[r]??0),0),[B,E]=x.useState(null),[F,_]=x.useState(!1),C=()=>{_(!1),E(null)};return d("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[d(Y,{className:"text-xs rounded-lg",children:[e(z,{className:"sticky top-0 left-0 z-10",children:d(f,{className:"bg-gray-200",children:[e(g,{className:"text-center",children:"Bulan"}),e(g,{className:"text-center",children:"Sirkulasi"}),p.map((a,r)=>e(g,{className:"text-center",children:R(a).format("DD-MM-YY")},r)),e(g,{className:"text-center",children:"Angsuran"}),e(g,{className:"text-center",children:"Saldo"})]})}),e(q,{children:l?l.map((a,r)=>e(H.Fragment,{children:d(f,{children:[e(n,{children:a.key}),e(n,{children:e(i,{value:a.sirkulasi})}),p.map((b,o)=>e(n,{className:"text-center",children:e(i,{value:a.instalment[b]})},o)),e(n,{children:e(i,{value:a.totalInstalment})}),e(n,{children:e(i,{value:a.sirkulasiAfter})})]})},r)):e(f,{children:e(n,{children:"a"})})}),d(G,{children:[d(f,{children:[e(n,{rowSpan:2,className:"text-center",children:"Total"}),e(n,{rowSpan:2,className:"text-center",children:e(i,{value:m(l,"sirkulasi")})}),p.map((a,r)=>e(n,{rowSpan:2,className:"text-center",children:e(i,{value:M(l,a)})},r)),e(n,{rowSpan:2,className:"text-center",children:e(i,{value:m(l,"totalInstalment")})}),m(l,"sirkulasiAfter")==S?e(n,{rowSpan:2,className:"text-center",children:e(i,{value:m(l,"sirkulasiAfter")})}):e(n,{className:"text-center",children:e(i,{value:m(l,"sirkulasiAfter")})})]}),e(f,{children:S&&m(l,"sirkulasiAfter")!=S?e(n,{className:"text-center bg-red-500",children:e(i,{value:S})}):""})]})]}),e(J,{datas:l,show:F,onClosed:C,triggeredId:B})]})};export{Se as default};
