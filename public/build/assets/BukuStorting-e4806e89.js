import{r as u,j as h,a as e,d as K,R as L}from"./app-467b6a76.js";import{T as P,a as Q,b as k,c as g,d as U,e as l,F as c,f as V}from"./FormatNumbering-635d6d81.js";import"./button-4900b3ad.js";import X from"./Action-4d8ec781.js";import Z from"./ApprovalAkhir-de573119.js";import"./utils-46f1eee5.js";import"./react-number-format.es-1310d9cd.js";import"./index-f96983da.js";import"./dialog-31b51e22.js";import"./index-cc972492.js";import"./react-icons.esm-503b848c.js";import"./index-e954674d.js";import"./card-92fabe96.js";import"./StatusPinjaman-531db8b1.js";import"./badge-e5f5a2f7.js";import"./BayarAngsuran-c1fbf2c5.js";import"./label-a93fee94.js";import"./index-ad336fc1.js";import"./input-b44e9a14.js";import"./index.esm-f30daa57.js";import"./Checkbox-4916f951.js";import"./Loading-c9fb64a7.js";import"./transition-37914111.js";import"./JenisNasabah-365fe271.js";import"./InputError-c2b8e2e9.js";import"./InputLabel-a18420f9.js";import"./PrimaryButton-68c87650.js";import"./SelectList-829a35d7.js";import"./DeleteAngsuran-5e29e515.js";import"./TextInput-07c30d56.js";import"./DeleteLoan-7151fde9.js";const Be=({dateOfWeek:f,datas:w,sirkulasi:y})=>{const[i,D]=u.useState([]),[S,T]=u.useState(0),[I,j]=u.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});u.useEffect(()=>{if(w){const s=w.map((r,b)=>(()=>{var N;const m={},A=(a=>Array.isArray(a)?a.length===0?{max:{},min:{}}:a.length===1?{max:{},min:a[0]}:a.reduce((t,n)=>{const o=new Date(n.date),G=new Date(t.min.date),J=new Date(t.max.date);return o<G&&(t.min=n),o>J&&(t.max=n),t},{max:a[0],min:a[0]}):{max:{},min:{}})(y);T(((N=A.max)==null?void 0:N.amount)??0);const Y=a=>{var t;switch(a.type){case"ml":return((t=A.min)==null?void 0:t.ml_amount)??0;default:return a.data.reduce((n,o)=>n+o.saldo_sebelumnya,0)}},z=a=>{var t;switch(a.type){case"ml":return((t=A.min)==null?void 0:t.ml_amount)??0;case"mb":return a.data.reduce((n,o)=>n+o.saldo_sebelumnya,0);case"cm":return a.data.reduce((n,o)=>n+o.saldo_sebelumnya,0);default:return a.data.reduce((n,o)=>n+o.saldo_sebelumnya,0)}},v=Y(r),q=z(r);f.forEach(a=>{m[a]=0});let x=0;return r.data.forEach(a=>{f.forEach(t=>{a.instalment[t]!==void 0&&(x+=a.instalment[t],m[t]+=a.instalment[t])})}),j(a=>({...a,[r.type]:{sirkulasi:v,angsuran:x,saldo:v-x}})),{key:r.month,instalment:{...m},sirkulasi:v,sirkulasii:q,totalInstalment:x,sirkulasiAfter:v-x}})());D(s)}},[w]);const B=(s,r)=>s.reduce((p,m)=>p+parseInt(m.instalment[r]??0),0),d=(s,r)=>s.reduce((p,m)=>p+parseInt(m[r]??0),0),[M,_]=u.useState(null),[C,E]=u.useState(!1),F=()=>{E(!1),_(null)},[R,H]=u.useState(!1),O=()=>{H(!1)};return h("div",{className:"relative overflow-auto h-[70vh] lg:h-[85vh] scrollbar-thin",children:[h(P,{className:"text-xs rounded-lg",children:[e(Q,{className:"sticky top-0 left-0 z-10",children:h(k,{className:"bg-gray-200",children:[e(g,{className:"text-center",children:"Bulan"}),e(g,{className:"text-center",children:"Sirkulasi"}),f.map((s,r)=>e(g,{className:"text-center whitespace-nowrap",children:K(s).format("DD-MM-YY")},r)),e(g,{className:"text-center",children:"Angsuran"}),e(g,{className:"text-center",children:"Saldo"})]})}),e(U,{children:i?i.map((s,r)=>e(L.Fragment,{children:h(k,{children:[e(l,{children:s.key}),e(l,{children:e(c,{value:s.sirkulasi})}),f.map((b,p)=>e(l,{className:"text-center whitespace-normal",children:e(c,{value:s.instalment[b]})},p)),e(l,{children:e(c,{value:s.totalInstalment})}),e(l,{children:e(c,{value:s.sirkulasiAfter})})]})},r)):e(k,{children:e(l,{children:"a"})})}),h(V,{children:[h(k,{children:[e(l,{rowSpan:2,className:"text-center",children:"Total"}),e(l,{rowSpan:2,className:"text-center",children:e(c,{value:d(i,"sirkulasi")})}),f.map((s,r)=>e(l,{rowSpan:2,className:"text-center",children:e(c,{value:B(i,s)})},r)),e(l,{rowSpan:2,className:"text-center",children:e(c,{value:d(i,"totalInstalment")})}),d(i,"sirkulasiAfter")==S?e(l,{rowSpan:2,className:"text-center",children:e(c,{value:d(i,"sirkulasiAfter")})}):e(l,{className:"text-center",children:e(c,{value:d(i,"sirkulasiAfter")})})]}),e(k,{children:S&&d(i,"sirkulasiAfter")!=S?e(l,{className:"text-center bg-red-500",children:e(c,{value:S})}):""})]})]}),e(Z,{show:R,onClosed:O,datas:I}),e(X,{datas:i,show:C,onClosed:F,triggeredId:M})]})};export{Be as default};
