import{r as u,j as c,a as t,d as R,R as z}from"./app-f22ec4d4.js";import{T as H,a as Y,b as f,c as p,d as $,e as r,f as q}from"./table-f41ea025.js";import{F as s}from"./FormatNumbering-9cedc195.js";import{B as G}from"./button-93fa4ceb.js";import J from"./Action22-8d21270f.js";import K from"./ApprovalAkhir-32f66c1e.js";import"./utils-3f044a58.js";import"./react-number-format.es-22455b8e.js";import"./index-e433ecc9.js";import"./dialog-68458697.js";import"./index-0e685d5a.js";import"./index-463c697e.js";import"./Combination-a453c124.js";import"./index-506eafa1.js";import"./react-icons.esm-b6da11e8.js";import"./card-d0d975d2.js";import"./StatusPinjaman-40ec7d33.js";import"./badge-241baf22.js";import"./BayarAngsuran-480c1a73.js";import"./label-70a262bf.js";import"./index-a3e9ae68.js";import"./input-a8ee1494.js";import"./index.esm-ea3969ea.js";import"./Checkbox-0d84b6cc.js";import"./Loading-bc0d1f00.js";import"./transition-79940a52.js";import"./JenisNasabah-5f1133b3.js";import"./InputError-1d5f2b3b.js";import"./InputLabel-caab201a.js";import"./PrimaryButton-529ff080.js";import"./SelectList-2b3c8a01.js";import"./DeleteAngsuran-1db00f13.js";import"./TextInput-6a8f4baa.js";import"./useFrontEndPermission-384b0fe6.js";import"./NoEditOverlay-794d6b4d.js";const It=({dateOfWeek:m,datas:N,sirkulasi:k})=>{const[n,y]=u.useState([]),[T,w]=u.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});u.useEffect(()=>{if(N){const e=N.map((a,h)=>(()=>{const i={},x=(l=>{switch(l.type){case"ml":return(k==null?void 0:k.ml_amount)??0;default:return l.data.reduce((o,P)=>o+P.saldo_sebelumnya,0)}})(a);m.forEach(l=>{i[l]=0});let g=0;const S=a.data.reduce((l,o)=>l+o.pemutihanThisMonth,0);return a.data.forEach(l=>{m.forEach(o=>{l.instalment[o]!==void 0&&(g+=l.instalment[o].total_nominal,i[o]+=l.instalment[o].total_nominal)})}),w(l=>({...l,[a.type]:{sirkulasi:x,angsuran:g,saldo:x-(g+S)}})),{key:a.month,instalment:{...i},sirkulasi:x,totalInstalment:g,totalPemutihan:S,sirkulasiAfter:x-(g+S),type:a.type}})());y(e)}},[N]);const I=(e,a)=>e.reduce((v,i)=>v+parseInt(i.instalment[a]??0),0),d=(e,a,h)=>e.reduce((i,A)=>h&&A.type==="normal"?i:i+parseInt(A[a]??0),0),[B,C]=u.useState(null),[F,j]=u.useState(!1),D=()=>{j(!1),C(null)},[E,b]=u.useState(!1),M=e=>{b(!0)},_=()=>{b(!1)};return c("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[c(H,{className:"text-xs rounded-lg",children:[t(Y,{className:"sticky top-0 left-0 z-10",children:c(f,{className:"bg-gray-200",children:[t(p,{className:"text-center",children:"Bulan"}),t(p,{className:"text-center",children:"Sirkulasi"}),m.map((e,a)=>t(p,{className:"text-center",children:R(e).format("DD-MM-YY")},a)),t(p,{className:"text-center",children:"Angsuran"}),t(p,{className:"text-center",children:"MD"}),t(p,{className:"text-center",children:"Saldo"})]})}),t($,{children:n?n.map((e,a)=>t(z.Fragment,{children:c(f,{children:[t(r,{children:e.key}),t(r,{className:`${e.type=="normal"?"bg-green-200":""} `,children:t(s,{value:e.sirkulasi})}),m.map((h,v)=>t(r,{className:"text-center",children:t(s,{value:e.instalment[h]})},v)),t(r,{children:t(s,{value:e.totalInstalment})}),t(r,{children:t(s,{value:e.totalPemutihan})}),t(r,{children:t(s,{value:e.sirkulasiAfter})})]})},a)):t(f,{children:t(r,{children:"a"})})}),c(q,{children:[c(f,{children:[t(r,{rowSpan:2,className:"text-center",children:"Total"}),t(r,{className:"text-center",children:t(s,{value:d(n,"sirkulasi",!0)})}),t(r,{className:"text-center",colspan:m.length+3})]}),c(f,{children:[t(r,{className:"text-center",children:t(s,{value:d(n,"sirkulasi")})}),m.map((e,a)=>t(r,{className:"text-center",children:t(s,{value:I(n,e)})},a)),t(r,{className:"text-center",children:t(s,{value:d(n,"totalInstalment")})}),t(r,{className:"text-center",children:t(s,{value:d(n,"totalPemutihan")})}),t(r,{className:"text-center",children:t(s,{value:d(n,"sirkulasiAfter")})})]})]})]}),c("div",{className:"flex items-center justify-end gap-3 mt-6",children:[t("div",{children:"Approval Akhir Bulan"}),t("div",{children:t(G,{onClick:M,variant:"green",size:"sm",children:"Approval"})})]}),t(K,{show:E,onClosed:_,datas:T}),t(J,{datas:n,show:F,onClosed:D,triggeredId:B})]})};export{It as default};
