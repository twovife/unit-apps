import{r as u,j as c,a as t,d as R,R as z}from"./app-5eeea420.js";import{T as H,a as Y,b as f,c as p,d as $,e as r,f as q}from"./table-94527c2e.js";import{F as s}from"./FormatNumbering-6b637a42.js";import{B as G}from"./button-e2a0104f.js";import J from"./Action22-e58d573d.js";import K from"./ApprovalAkhir-1bb4928d.js";import"./utils-3f044a58.js";import"./react-number-format.es-5528281f.js";import"./index-2f1470d8.js";import"./dialog-0e7748bc.js";import"./index-f0f96044.js";import"./index-89a89683.js";import"./Combination-c509d3eb.js";import"./index-ab77748e.js";import"./react-icons.esm-74782f46.js";import"./card-6245596e.js";import"./StatusPinjaman-aa5799ea.js";import"./badge-7db12edd.js";import"./BayarAngsuran-f8a10804.js";import"./label-4c08b0de.js";import"./index-0a2ae204.js";import"./input-722b6b4e.js";import"./index.esm-ea7c83bb.js";import"./Checkbox-a5ba6691.js";import"./Loading-c4737e9d.js";import"./transition-c9ac40d5.js";import"./JenisNasabah-2196ddea.js";import"./InputError-3abd7461.js";import"./InputLabel-f6d2acb5.js";import"./PrimaryButton-67c6a6fd.js";import"./SelectList-e0ea69f9.js";import"./DeleteAngsuran-102a776a.js";import"./TextInput-c1ef193f.js";import"./useFrontEndPermission-524b4785.js";import"./NoEditOverlay-67314454.js";const It=({dateOfWeek:m,datas:N,sirkulasi:k})=>{const[n,y]=u.useState([]),[T,w]=u.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});u.useEffect(()=>{if(N){const e=N.map((a,h)=>(()=>{const i={},x=(l=>{switch(l.type){case"ml":return(k==null?void 0:k.ml_amount)??0;default:return l.data.reduce((o,P)=>o+P.saldo_sebelumnya,0)}})(a);m.forEach(l=>{i[l]=0});let g=0;const S=a.data.reduce((l,o)=>l+o.pemutihanThisMonth,0);return a.data.forEach(l=>{m.forEach(o=>{l.instalment[o]!==void 0&&(g+=l.instalment[o].total_nominal,i[o]+=l.instalment[o].total_nominal)})}),w(l=>({...l,[a.type]:{sirkulasi:x,angsuran:g,saldo:x-(g+S)}})),{key:a.month,instalment:{...i},sirkulasi:x,totalInstalment:g,totalPemutihan:S,sirkulasiAfter:x-(g+S),type:a.type}})());y(e)}},[N]);const I=(e,a)=>e.reduce((v,i)=>v+parseInt(i.instalment[a]??0),0),d=(e,a,h)=>e.reduce((i,A)=>h&&A.type==="normal"?i:i+parseInt(A[a]??0),0),[B,C]=u.useState(null),[F,j]=u.useState(!1),D=()=>{j(!1),C(null)},[E,b]=u.useState(!1),M=e=>{b(!0)},_=()=>{b(!1)};return c("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[c(H,{className:"text-xs rounded-lg",children:[t(Y,{className:"sticky top-0 left-0 z-10",children:c(f,{className:"bg-gray-200",children:[t(p,{className:"text-center",children:"Bulan"}),t(p,{className:"text-center",children:"Sirkulasi"}),m.map((e,a)=>t(p,{className:"text-center",children:R(e).format("DD-MM-YY")},a)),t(p,{className:"text-center",children:"Angsuran"}),t(p,{className:"text-center",children:"MD"}),t(p,{className:"text-center",children:"Saldo"})]})}),t($,{children:n?n.map((e,a)=>t(z.Fragment,{children:c(f,{children:[t(r,{children:e.key}),t(r,{className:`${e.type=="normal"?"bg-green-200":""} `,children:t(s,{value:e.sirkulasi})}),m.map((h,v)=>t(r,{className:"text-center",children:t(s,{value:e.instalment[h]})},v)),t(r,{children:t(s,{value:e.totalInstalment})}),t(r,{children:t(s,{value:e.totalPemutihan})}),t(r,{children:t(s,{value:e.sirkulasiAfter})})]})},a)):t(f,{children:t(r,{children:"a"})})}),c(q,{children:[c(f,{children:[t(r,{rowSpan:2,className:"text-center",children:"Total"}),t(r,{className:"text-center",children:t(s,{value:d(n,"sirkulasi",!0)})}),t(r,{className:"text-center",colspan:m.length+3})]}),c(f,{children:[t(r,{className:"text-center",children:t(s,{value:d(n,"sirkulasi")})}),m.map((e,a)=>t(r,{className:"text-center",children:t(s,{value:I(n,e)})},a)),t(r,{className:"text-center",children:t(s,{value:d(n,"totalInstalment")})}),t(r,{className:"text-center",children:t(s,{value:d(n,"totalPemutihan")})}),t(r,{className:"text-center",children:t(s,{value:d(n,"sirkulasiAfter")})})]})]})]}),c("div",{className:"flex items-center justify-end gap-3 mt-6",children:[t("div",{children:"Approval Akhir Bulan"}),t("div",{children:t(G,{onClick:M,variant:"green",size:"sm",children:"Approval"})})]}),t(K,{show:E,onClosed:_,datas:T}),t(J,{datas:n,show:F,onClosed:D,triggeredId:B})]})};export{It as default};
