import{r as d,X as L,G as q,j as e}from"./app-ns96WniE.js";import{C as z,a as T,b as B,d as P}from"./card-BENIATWH.js";import{L as j}from"./label-dPIdyTXP.js";import{I as H}from"./input-CSn3wVhG.js";import{C as M}from"./index.esm-VUGX4ntA.js";import{C as V}from"./Checkbox-k7xLF4dI.js";import{B as m}from"./button-BdBexs_k.js";import{L as G}from"./Loading-CQcppPTv.js";import"./utils-CytzSlOG.js";import"./index-BrmqkDWz.js";import"./index-BYjqc5GM.js";import"./index-D7YONi1a.js";import"./index-Gs9KmwE-.js";import"./transition-DQ1_kMjs.js";const se=({triggeredId:f,triggeredPinjaman:h,instalment:p})=>{const[y,C]=d.useState({});d.useEffect(()=>{C(h)},[h]);const{server_filter:{closed_transaction:N,today:k}}=L().props,{data:l,setData:r,post:_,processing:w,reset:S,recentlySuccessful:I}=q({type_transaksi:"bayar",transaction_date:"",nominal:0,id:""});d.useEffect(()=>{r("id",f)},[f,I]);const D=(a,n)=>{r(n,a)},g=a=>{r(a.target.name,a.target.type==="checkbox"?a.target.checked:a.target.value)},R=a=>{const n=a.target.getAttribute("data-value");r("nominal",n)},x=a=>{const n=parseInt(l.nominal),c=parseInt(a.target.getAttribute("data-value"));r("nominal",c+n)},A=a=>{a.preventDefault(),_(route("pinjaman.bayar_pinjaman",l.id),{preserveScroll:!0,onSuccess:()=>{S("transaction_date","nominal")}})},[v,E]=d.useState([5e4,52e3,6e4,65e3,1e5,13e4,195e3,26e4,39e4]);return d.useEffect(()=>{var a;if(r(n=>({...n,transaction_date:k})),p.length>0){const c=Number((u=>{const s=u.reduce((t,{nomor:i})=>(t[i]=(t[i]||0)+1,t),{});return Object.keys(s).reduce((t,i)=>s[t]>s[i]?t:i)})(p)),b=((a=p.sort((u,s)=>u.saldo-s.saldo)[0])==null?void 0:a.saldo)??0;E(u=>{const s=!isNaN(c)&&c>0?c:null,t=!isNaN(b)&&b>0?b:null;return[...new Set([...u.filter(o=>o!==s&&o!==t),s,t].filter(o=>o!==null))].sort((o,F)=>o-F)})}},[p]),e.jsxs(z,{className:"relative w-full mb-3",children:[e.jsx(G,{show:w}),e.jsx(T,{children:e.jsx(B,{children:"Isi Angsuran"})}),e.jsx(P,{className:"relative",children:e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"transaction_date",children:"Tanggal Pembayaran"}),e.jsx(H,{type:"date",min:N,name:"transaction_date",id:"transaction_date",className:"w-full",value:l.transaction_date,onChange:g})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"nominal",children:"Nominal"}),e.jsx(M,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"nominal",allowDecimals:!1,prefix:"Rp. ",min:0,required:!0,onValueChange:D,value:l.nominal,placeholder:"Inputkan angka tanpa sparator"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(m,{type:"button",variant:"outline",size:"xs",onClick:x,"data-value":1e3,children:"+1 Rb"}),e.jsx(m,{type:"button",variant:"outline",size:"xs",onClick:x,"data-value":5e3,children:"+5 Rb"}),e.jsx(m,{type:"button",variant:"outline",size:"xs",onClick:x,"data-value":1e4,children:"+10 Rb"}),v&&v.map(a=>e.jsxs(m,{type:"button",variant:"outline",size:"xs",onClick:R,"data-value":a,children:[(a/1e3).toLocaleString("id-ID")," Rb"]}))]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("div",{children:y.status_pinjaman!=="normal"&&e.jsxs("label",{className:"flex items-center",children:[e.jsx(V,{name:"danatitipan",value:l.danatitipan,onChange:g}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Dana Titipan?"})]})}),e.jsx(m,{type:"submit",children:"Submit"})]})]})})]})};export{se as default};
