import{r as o,a as e,j as f,d as R,R as H}from"./app-f21784f0.js";import{T as Y,a as z,b as p,c as b,d as C,e as r,F as c,f as O}from"./FormatNumbering-1c663758.js";import"./utils-46f1eee5.js";import"./react-number-format.es-60082643.js";const Q=({dateOfWeek:x,datas:v,sirkulasi:A})=>{const[u,w]=o.useState([]),[g,T]=o.useState(0),[q,j]=o.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});o.useEffect(()=>{if(v){const t=v.map((l,S)=>(()=>{var D;const m={},y=(a=>Array.isArray(a)?a.length===0?{max:{},min:{}}:a.length===1?{max:{},min:a[0]}:a.reduce((s,n)=>{const i=new Date(n.date),E=new Date(s.min.date),F=new Date(s.max.date);return i<E&&(s.min=n),i>F&&(s.max=n),s},{max:a[0],min:a[0]}):{max:{},min:{}})(A);T(((D=y.max)==null?void 0:D.amount)??0);const I=a=>{var s;switch(a.type){case"ml":return((s=y.min)==null?void 0:s.ml_amount)??0;default:return a.data.reduce((n,i)=>n+i.saldo_sebelumnya,0)}},M=a=>{var s;switch(a.type){case"ml":return((s=y.min)==null?void 0:s.ml_amount)??0;case"mb":return a.data.reduce((n,i)=>n+i.saldo_sebelumnya,0);case"cm":return a.data.reduce((n,i)=>n+i.saldo_sebelumnya,0);default:return a.data.reduce((n,i)=>n+i.saldo_sebelumnya,0)}},N=I(l),_=M(l);x.forEach(a=>{m[a]=0});let k=0;return l.data.forEach(a=>{x.forEach(s=>{a.instalment[s]!==void 0&&(k+=a.instalment[s],m[s]+=a.instalment[s])})}),j(a=>({...a,[l.type]:{sirkulasi:N,angsuran:k,saldo:N-k}})),{key:l.month,instalment:{...m},sirkulasi:N,sirkulasii:_,totalInstalment:k,sirkulasiAfter:N-k}})());w(t)}},[v]);const B=(t,l)=>t.reduce((h,m)=>h+parseInt(m.instalment[l]??0),0),d=(t,l)=>t.reduce((h,m)=>h+parseInt(m[l]??0),0);return o.useState(null),o.useState(!1),o.useState(!1),e("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:f(Y,{className:"text-xs rounded-lg",children:[e(z,{className:"sticky top-0 left-0 z-10",children:f(p,{className:"bg-gray-200",children:[e(b,{className:"text-center",children:"Bulan"}),e(b,{className:"text-center",children:"Sirkulasi"}),x.map((t,l)=>e(b,{className:"text-center",children:R(t).format("DD-MM-YY")},l)),e(b,{className:"text-center",children:"Angsuran"}),e(b,{className:"text-center",children:"Saldo"})]})}),e(C,{children:u?u.map((t,l)=>e(H.Fragment,{children:f(p,{children:[e(r,{children:t.key}),e(r,{children:e(c,{value:t.sirkulasi})}),x.map((S,h)=>e(r,{className:"text-center",children:e(c,{value:t.instalment[S]})},h)),e(r,{children:e(c,{value:t.totalInstalment})}),e(r,{children:e(c,{value:t.sirkulasiAfter})})]})},l)):e(p,{children:e(r,{children:"a"})})}),f(O,{children:[f(p,{children:[e(r,{rowSpan:2,className:"text-center",children:"Total"}),e(r,{rowSpan:2,className:"text-center",children:e(c,{value:d(u,"sirkulasi")})}),x.map((t,l)=>e(r,{rowSpan:2,className:"text-center",children:e(c,{value:B(u,t)})},l)),e(r,{rowSpan:2,className:"text-center",children:e(c,{value:d(u,"totalInstalment")})}),d(u,"sirkulasiAfter")==g?e(r,{rowSpan:2,className:"text-center",children:e(c,{value:d(u,"sirkulasiAfter")})}):e(r,{className:"text-center",children:e(c,{value:d(u,"sirkulasiAfter")})})]}),e(p,{children:g&&d(u,"sirkulasiAfter")!=g?e(r,{className:"text-center bg-red-500",children:e(c,{value:g})}):""})]})]})})};export{Q as default};
