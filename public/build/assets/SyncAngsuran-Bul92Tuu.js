import{r as i,G as F,X as w,e as H,j as e,d as u}from"./app-bXPm8Awk.js";import{D as U,a as O,b as $,c as W}from"./dialog-Dbdu8q_j.js";import{T as X,a as z,b as M,c as D,d as J,e as A}from"./table-R_6ifxuY.js";import{I as y}from"./InputLabel-Cw9vIhSu.js";import"./TextInput-DFL8_9K6.js";import{C as B}from"./index.esm-DvMKBlS-.js";import{B as K}from"./button-C4BLr6ZZ.js";import{L as Q}from"./Loading-B2jB85QB.js";import Z from"./ButtonAngsuran-B-zG0c-3.js";import"./index-Bj5K4mWo.js";import"./index-Bf8gwDjN.js";import"./index-COj3Wzbp.js";import"./Combination-C6uq3daI.js";import"./index-QN2HXasF.js";import"./index-DpfqK8IF.js";import"./react-icons.esm-E17PPhRE.js";import"./utils-CytzSlOG.js";import"./transition-DBWX2fsk.js";const je=({show:d=d,onClosed:C,triggeredId:m})=>{var b;const[t,p]=i.useState(null),[f,T]=i.useState(0),{data:s,setData:c,post:k,processing:I,reset:_}=F({saldobefore:0,month:"",id:"",instalment:[]}),h=()=>{C(),_(),p(null)},E=(b=w().props.server_filter)==null?void 0:b.month,R=w().props.dateOfWeek;i.useEffect(()=>{d&&m&&H.post(route("pinjaman.get_synch_angsuran",m),{month:E,dateofweek:R}).then(a=>{var n;p((n=a.data)==null?void 0:n.data),c(l=>{var o,r,g,j,v,N,S,Y;return{...l,saldobefore:(r=(o=a.data)==null?void 0:o.data)==null?void 0:r.saldoSebelumnya,id:(j=(g=a.data)==null?void 0:g.data)==null?void 0:j.id,month:(N=(v=a.data)==null?void 0:v.data)==null?void 0:N.month,instalment:(Y=(S=a.data)==null?void 0:S.data)==null?void 0:Y.angsuran}})})},[d,m]);const x=(a,n,l=null)=>{if(l!==null){const o=[...s.instalment];o[l]={...o[l],nominal:a},c("instalment",o)}else c(n,a)};i.useEffect(()=>{var a;if(t){const n=s==null?void 0:s.saldobefore,l=(a=s==null?void 0:s.instalment)==null?void 0:a.reduce((o,r)=>o+(parseFloat(r.nominal)||0),0);T(n-l)}},[t,s]);const[L,ee]=i.useState([1e4,3e4,5e4,52e3,6e4,65e3,1e5,104e3,13e4,195e3,26e4,39e4]),[G,P]=i.useState(null),V=a=>{a.preventDefault(),k(route("pinjaman.synch_angsuran",m),{preserveScroll:!0,onSuccess:()=>{h()}})},q=(a,n)=>{const l=[...s.instalment];l[n]={...l[n],nominal:a},c("instalment",l)};return e.jsxs(U,{open:d,onOpenChange:a=>a?"":h(),children:[e.jsx(Q,{show:I}),e.jsxs(O,{className:"p-1 lg:p-6 min-w-[50vw] max-w-[90vw] w-auto",children:[e.jsx($,{children:e.jsx(W,{children:"Angsuran"})}),e.jsx("div",{className:"h-[80vh]",children:t?e.jsxs("div",{className:"lg:grid-cols-2 grid w-full gap-3",children:[e.jsxs("form",{onSubmit:V,children:[e.jsx("p",{children:"Perbaiki Angsuran"}),e.jsxs("div",{className:"mb-1",children:["ANGSURAN PER"," ",e.jsx("span",{className:"text-green-500 font-semibold",children:u(t==null?void 0:t.month).format("MMMM YYYY")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(y,{value:`Saldo  ${u(t==null?void 0:t.month).format("MMMM YYYY")}`}),e.jsx(B,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-xs h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"saldobefore",defaultValue:0,allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:(a,n)=>x(a,n),value:s.saldobefore,placeholder:"Inputkan angka tanpa sparator"})]}),(s==null?void 0:s.instalment)&&(s==null?void 0:s.instalment.map((a,n)=>{var l;return e.jsxs("div",{className:"mb-1 relative",children:[e.jsx(y,{value:`Angsuran ${u(a==null?void 0:a.transaction_date).format("DD-MM-YYYY")}`}),e.jsx(B,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-xs h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 mb-2",name:"request_nominal",defaultValue:0,allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onFocus:o=>P(n),onValueChange:(o,r)=>x(o,r,n),value:(l=s.instalment[n])==null?void 0:l.nominal,placeholder:"Inputkan angka tanpa sparator"}),G==n&&e.jsx(Z,{nominalPembayaran:L,pelunasan:f,onClickButton:q,index:n})]})})),e.jsx("div",{children:e.jsx(K,{variant:"green",type:"submit",children:"Submit"})}),e.jsx("div",{className:"text-green-500 font-semibold text-lg",children:f.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Detail Angsuran"}),e.jsx("div",{className:"mb-1",children:t&&e.jsxs(X,{children:[e.jsx(z,{children:e.jsxs(M,{children:[e.jsx(D,{children:"Date"}),e.jsx(D,{children:"Nominal"})]})}),e.jsx(J,{children:t&&(t==null?void 0:t.instalments.map(a=>{var n;return e.jsxs(M,{children:[e.jsx(A,{children:u(a==null?void 0:a.transaction_date).format("DD/MM/YYYY")}),e.jsx(A,{children:(n=a.nominal)==null?void 0:n.toLocaleString()})]})}))})]})})]})]}):e.jsx("div",{children:"MENUNGGU DATA"})})]})]})};export{je as default};
