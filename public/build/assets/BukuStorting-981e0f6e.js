import{r as x,j as d,a as e,d as R,R as H}from"./app-41d5673e.js";import{T as Y,a as z,b as f,c as g,d as q,e as n,F as i,f as G}from"./FormatNumbering-a833c6fb.js";import"./button-057951ef.js";import J from"./Action-fe84351c.js";import"./utils-46f1eee5.js";import"./react-number-format.es-57e38fbd.js";import"./index-f96983da.js";import"./dialog-b793649e.js";import"./index-8cbfe5a8.js";import"./react-icons.esm-a3de7cc3.js";import"./index-f95c71ba.js";import"./card-1dba19be.js";import"./badge-9f92a9ef.js";import"./BayarAngsuran-8847cedc.js";import"./label-98969326.js";import"./index-c16c7f37.js";import"./input-49486b23.js";import"./index.esm-0ecf8ea0.js";import"./Checkbox-f0b84731.js";import"./Loading-3bfd7043.js";import"./transition-62e5107d.js";import"./JenisNasabah-0b973bff.js";import"./InputError-d9283e84.js";import"./InputLabel-93c709a2.js";import"./PrimaryButton-e6716347.js";import"./SelectList-2686c4f4.js";import"./DeleteAngsuran-a1930f78.js";import"./TextInput-a1bdf03f.js";import"./DeleteLoan-bc17a55c.js";const Ne=({dateOfWeek:p,datas:k,sirkulasi:y})=>{const[l,I]=x.useState([]),[S,j]=x.useState(0);x.useEffect(()=>{if(k){const a=k.map((r,b)=>(()=>{var T;const c={},N=(t=>Array.isArray(t)?t.length===0?{max:{},min:{}}:t.length===1?{max:{},min:t[0]}:t.reduce((s,u)=>{const h=new Date(u.date),D=new Date(s.min.date),w=new Date(s.max.date);return h<D&&(s.min=u),h>w&&(s.max=u),s},{max:t[0],min:t[0]}):{max:{},min:{}})(y);j(((T=N.max)==null?void 0:T.amount)??0);const A=(t=>{var s,u,h;switch(t.type){case"ml":return((s=N.min)==null?void 0:s.ml_amount)??0;case"mb":return((u=N.min)==null?void 0:u.mb_amount)??0;case"cm":return((h=N.min)==null?void 0:h.cm_amount)??0;default:return t.data.reduce((D,w)=>D+w.saldo_sebelumnya,0)}})(r);p.forEach(t=>{c[t]=0});let v=0;return r.data.forEach(t=>{p.forEach(s=>{t.instalment[s]!==void 0&&(v+=t.instalment[s],c[s]+=t.instalment[s])})}),{key:r.month,instalment:{...c},sirkulasi:A,totalInstalment:v,sirkulasiAfter:A-v}})());I(a)}},[k]);const M=(a,r)=>a.reduce((o,c)=>o+parseInt(c.instalment[r]??0),0),m=(a,r)=>a.reduce((o,c)=>o+parseInt(c[r]??0),0),[B,E]=x.useState(null),[F,_]=x.useState(!1),C=()=>{_(!1),E(null)};return d("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[d(Y,{className:"text-xs rounded-lg",children:[e(z,{className:"sticky top-0 left-0 z-10",children:d(f,{className:"bg-gray-200",children:[e(g,{className:"text-center",children:"Bulan"}),e(g,{className:"text-center",children:"Sirkulasi"}),p.map((a,r)=>e(g,{className:"text-center",children:R(a).format("DD-MM-YY")},r)),e(g,{className:"text-center",children:"Angsuran"}),e(g,{className:"text-center",children:"Saldo"})]})}),e(q,{children:l?l.map((a,r)=>e(H.Fragment,{children:d(f,{children:[e(n,{children:a.key}),e(n,{children:e(i,{value:a.sirkulasi})}),p.map((b,o)=>e(n,{className:"text-center",children:e(i,{value:a.instalment[b]})},o)),e(n,{children:e(i,{value:a.totalInstalment})}),e(n,{children:e(i,{value:a.sirkulasiAfter})})]})},r)):e(f,{children:e(n,{children:"a"})})}),d(G,{children:[d(f,{children:[e(n,{rowSpan:2,className:"text-center",children:"Total"}),e(n,{rowSpan:2,className:"text-center",children:e(i,{value:m(l,"sirkulasi")})}),p.map((a,r)=>e(n,{rowSpan:2,className:"text-center",children:e(i,{value:M(l,a)})},r)),e(n,{rowSpan:2,className:"text-center",children:e(i,{value:m(l,"totalInstalment")})}),m(l,"sirkulasiAfter")==S?e(n,{rowSpan:2,className:"text-center",children:e(i,{value:m(l,"sirkulasiAfter")})}):e(n,{className:"text-center",children:e(i,{value:m(l,"sirkulasiAfter")})})]}),e(f,{children:S&&m(l,"sirkulasiAfter")!=S?e(n,{className:"text-center bg-red-500",children:e(i,{value:S})}):""})]})]}),e(J,{datas:l,show:F,onClosed:C,triggeredId:B})]})};export{Ne as default};
