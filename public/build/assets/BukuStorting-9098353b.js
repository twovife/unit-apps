import{r as u,j as o,a as t,c as z,R as H}from"./app-89964f60.js";import{T as M,a as Y,b as v,c as g,d as $,e as r,f as q}from"./table-bf376661.js";import{F as l}from"./FormatNumbering-e171b06a.js";import{B as G}from"./button-662018a0.js";import J from"./Action-20dd093b.js";import K from"./ApprovalAkhir-3a5622f9.js";import"./utils-aa679991.js";import"./react-number-format.es-33d4ddf3.js";import"./dialog-cd6574bf.js";import"./index-07e776c0.js";import"./react-icons.esm-f5117589.js";import"./card-662026ea.js";import"./badge-cca44c2f.js";import"./BayarAngsuran-2b3aec43.js";import"./label-e1be8c98.js";import"./index-bcb7b51f.js";import"./index-ea477c8f.js";import"./input-dda9d482.js";import"./index.esm-520ad08f.js";import"./Checkbox-e7d1ea02.js";import"./Loading-ceec09d3.js";import"./transition-16898277.js";import"./JenisNasabah-09254b7f.js";import"./InputError-bf69eb8a.js";import"./InputLabel-518c5e05.js";import"./PrimaryButton-7a0acf8f.js";import"./SelectList-389240a1.js";import"./DeleteAngsuran-177c7766.js";import"./TextInput-f8fd75ba.js";import"./DeleteLoan-8f9dc4c8.js";import"./useFrontEndPermission-3fddc876.js";import"./NoEditOverlay-b8442ca0.js";import"./sonner-87354e32.js";import"./createLucideIcon-6426f9be.js";import"./use-mobile-4a7e3d84.js";import"./BadgeStatus-4c91a3a0.js";const It=({dateOfWeek:c,datas:N,sirkulasi:k})=>{const[n,b]=u.useState([]),[y,T]=u.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});u.useEffect(()=>{if(N){const e=N.map((a,p)=>(()=>{const i={},x=(s=>{switch(s.type){case"ml":return(k==null?void 0:k.ml_amount)??0;default:return s.data.reduce((m,R)=>m+R.saldo_sebelumnya,0)}})(a);c.forEach(s=>{i[s]=0});let h=0;return a.data.forEach(s=>{c.forEach(m=>{s.instalment[m]!==void 0&&(h+=s.instalment[m].total_nominal,i[m]+=s.instalment[m].total_nominal)})}),T(s=>({...s,[a.type]:{sirkulasi:x,angsuran:h,saldo:x-h}})),{key:a.month,instalment:{...i},sirkulasi:x,totalInstalment:h,sirkulasiAfter:x-h,type:a.type}})());b(e)}},[N]);const w=(e,a)=>e.reduce((d,i)=>d+parseInt(i.instalment[a]??0),0),f=(e,a,p)=>e.reduce((i,A)=>p&&A.type==="normal"?i:i+parseInt(A[a]??0),0),[I,B]=u.useState(null),[C,F]=u.useState(!1),j=()=>{F(!1),B(null)},[E,S]=u.useState(!1),D=e=>{S(!0)},_=()=>{S(!1)};return o("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[o(M,{className:"text-xs rounded-lg",children:[t(Y,{className:"sticky top-0 left-0 z-10",children:o(v,{className:"bg-gray-200",children:[t(g,{className:"text-center",children:"Bulan"}),t(g,{className:"text-center",children:"Sirkulasi"}),c.map((e,a)=>t(g,{className:"text-center",children:z(e).format("DD-MM-YY")},a)),t(g,{className:"text-center",children:"Angsuran"}),t(g,{className:"text-center",children:"Saldo"})]})}),t($,{children:n?n.map((e,a)=>t(H.Fragment,{children:o(v,{children:[t(r,{children:e.key}),t(r,{className:`${e.type=="normal"?"bg-green-200":""} `,children:t(l,{value:e.sirkulasi})}),c.map((p,d)=>t(r,{className:"text-center",children:t(l,{value:e.instalment[p]})},d)),t(r,{children:t(l,{value:e.totalInstalment})}),t(r,{children:t(l,{value:e.sirkulasiAfter})})]})},a)):t(v,{children:t(r,{children:"a"})})}),o(q,{children:[o(v,{children:[t(r,{rowSpan:2,className:"text-center",children:"Total"}),t(r,{className:"text-center",children:t(l,{value:f(n,"sirkulasi",!0)})}),t(r,{className:"text-center",colspan:c.length+2})]}),o(v,{children:[t(r,{className:"text-center",children:t(l,{value:f(n,"sirkulasi")})}),c.map((e,a)=>t(r,{className:"text-center",children:t(l,{value:w(n,e)})},a)),t(r,{className:"text-center",children:t(l,{value:f(n,"totalInstalment")})}),t(r,{className:"text-center",children:t(l,{value:f(n,"sirkulasiAfter")})})]})]})]}),o("div",{className:"flex items-center justify-end gap-3 mt-6",children:[t("div",{children:"Approval Akhir Bulan"}),t("div",{children:t(G,{onClick:D,variant:"green",size:"sm",children:"Approval"})})]}),t(K,{show:E,onClosed:_,datas:y}),t(J,{datas:n,show:C,onClosed:j,triggeredId:I})]})};export{It as default};
