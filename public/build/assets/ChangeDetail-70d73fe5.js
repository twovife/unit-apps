import{W as F,r as b,j as a,a as n,F as L}from"./app-2fa7c2a6.js";import{L as A}from"./Loading-e8849bd6.js";import{N as E}from"./NoEditOverlay-8029b7d5.js";import{u as S}from"./useFrontEndPermission-a6b160d7.js";import{B as _}from"./button-efb50510.js";import{I as v}from"./input-ad8a6d1d.js";import{L as i}from"./label-2d1774de.js";import{C as m}from"./index.esm-0365c025.js";import"./transition-502bb836.js";import"./utils-36e2ef84.js";import"./index-47ec68c5.js";import"./index-1a81e09c.js";const Y=({triggeredData:e,onClosed:x})=>{const{isUnit:I,isMantri:N,isPusat:B,isCreator:T}=S(),{data:l,setData:t,put:q,processing:w,reset:y,transform:j,errors:O}=F({request_date:"",drop_date:"",request_nominal:"",approved_nominal:"",nominal_drop:"",drop_langsung:""}),[p,c]=b.useState(null);b.useEffect(()=>{e&&t(o=>({...o,request_date:e.request_date,drop_date:e.tanggal_drop,drop_langsung:e.drop_langsung,request_nominal:e.drop_langsung=="baru"?e.drop_jadi:e.request,approved_nominal:e.acc,nominal_drop:e.drop_jadi}))},[e]);const f=o=>{c(null);const{name:s,value:u}=o.target,k=s==="request_date"&&l.drop_date===u,C=s==="drop_date"&&l.request_date===u,r=k||C,P=(e==null?void 0:e.status)=="gagal"||(e==null?void 0:e.status)=="tolak";if(r&&P)return c("Status GAGAL / TOLAK tidak bisa diubah ke drop Langsung / Pengajuan"),null;t(R=>({...R,[s]:u,drop_langsung:r?"baru":"lama",request_nominal:r?null:e.drop_langsung=="baru"?e.drop_jadi:e.request,approved_nominal:r?null:e.drop_langsung=="baru"?e.drop_jadi:e.acc,nominal_drop:r?e.drop_langsung=="baru"?e.drop_jadi:e.request:e.status=="success"?e.drop_jadi:null}))},d=(o,s)=>{t(s,o)},h=o=>{j(s=>({...s,updateType:o})),q(route("transaction.updateEverything",e==null?void 0:e.nomor_pengajuan),{preventDefault:!0,preserveState:!0,onSuccess:()=>{y(),x()}})};return a("form",{onSubmit:o=>o.preventDefault(),children:[N&&n(E,{value:"Hanya bisa dilakukan oleh Pimpinan / Staff"}),n(A,{show:w}),a("div",{className:"mb-1 ",children:[a("div",{className:"flex w-full gap-3",children:[a("div",{className:"flex-1",children:[n(i,{htmlFor:"request_date",children:"Tanggal Pengajuan"}),n(v,{type:"date",onChange:f,value:l.request_date,id:"request_date",max:l.drop_date,required:!0,name:"request_date"})]}),a("div",{className:"flex-1",children:[n(i,{htmlFor:"drop_date",children:"Tanggal Drop"}),n(v,{type:"date",onChange:f,value:l.drop_date,id:"drop_date",min:l.request_date,required:!0,name:"drop_date"})]})]}),p?n("div",{className:"font-semibold text-red-500",children:p}):l.drop_langsung=="baru"?n("div",{className:"text-red-500 w-fullfont-semibold",children:"DROP BARU"}):n("div",{className:"w-full font-semibold text-red-500",children:"PENGAJUAN DROP"})]}),a("div",{className:"mb-3",children:[n("div",{className:"text-xs text-blue-500",children:"Perubahan Tanggal Mempengaruhi Perolehan Drop dan Rencana Drop"}),a("div",{className:"text-xs",children:["Jika ",n("span",{className:"font-semibold text-blue-500",children:"Drop Baru"})," ","diubah ke"," ",n("span",{className:"font-semibold text-blue-500",children:"Drop Lama / Pengajuan"})]})]}),a("div",{className:"flex w-full gap-3 mb-1",children:[l.drop_langsung=="lama"&&a(L,{children:[a("div",{className:"flex-1",children:[n(i,{htmlFor:"request_nominal",children:"Nominal Pengajuan"}),n(m,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"request_nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:d,value:l.request_nominal,placeholder:"Inputkan angka tanpa sparator"})]}),l.approved_nominal&&a("div",{className:"flex-1",children:[n(i,{htmlFor:"approved_nominal",children:"Nominal Acc"}),n(m,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"approved_nominal",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:d,value:l.approved_nominal,placeholder:"Inputkan angka tanpa sparator"})]})]}),l.nominal_drop&&a("div",{className:"flex-1",children:[n(i,{htmlFor:"nominal_drop",children:"Drop Jadi"}),n(m,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"nominal_drop",allowDecimals:!1,prefix:"Rp. ",min:1,required:!0,onValueChange:d,value:l.nominal_drop,placeholder:"Inputkan angka tanpa sparator"})]})]}),a("div",{className:"mb-3",children:[n("div",{className:"text-xs text-blue-500",children:"Perubahan Nominal Mempengaruhi Perolehan Drop dan Rencana Drop"}),n("div",{className:"text-xs text-yellow-500",children:"Reset Pinjaman akan menghilangkan semua data angsuran pada pinjaman ini"})]}),a("div",{className:"flex items-center justify-between",children:[n(_,{onClick:()=>h("detailchange"),type:"submit",children:"Ubah"}),(e==null?void 0:e.drop_langsung)=="lama"&&n(_,{onClick:()=>h("resetdata"),variant:"yellow",type:"submit",children:"Reset Pinjaman"})]})]})};export{Y as default};
