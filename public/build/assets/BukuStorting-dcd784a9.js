import{r as p,j as i,a as e,c as z,R as H}from"./app-01dbd2ca.js";import{T as M,a as Y,b as f,c as x,d as $,e as r,F as s,f as q}from"./FormatNumbering-750d2fb1.js";import{B as G}from"./button-e594156b.js";import J from"./Action-60649a58.js";import K from"./ApprovalAkhir-c3f4ce00.js";import"./utils-36e2ef84.js";import"./react-number-format.es-7ab5d1fe.js";import"./dialog-e5ae602b.js";import"./index-4d3b6f23.js";import"./index-0257f697.js";import"./react-icons.esm-e69bb1a2.js";import"./index-e96bcad6.js";import"./card-7ec1f0b3.js";import"./badge-61cfb712.js";import"./BayarAngsuran-95d47900.js";import"./label-a59e5876.js";import"./index-be647e53.js";import"./input-2f9dcac5.js";import"./index.esm-eff4be9d.js";import"./Checkbox-b0b6d04c.js";import"./Loading-bacf33e9.js";import"./transition-37508b69.js";import"./JenisNasabah-d348251b.js";import"./InputError-95ccc56c.js";import"./InputLabel-2f797a2a.js";import"./PrimaryButton-bb92d023.js";import"./SelectList-36b0d6d1.js";import"./DeleteAngsuran-a9ee9f9a.js";import"./TextInput-9ea5dd41.js";import"./DeleteLoan-8e3f9411.js";import"./useFrontEndPermission-7736c5f3.js";import"./NoEditOverlay-5ca8dba7.js";const ye=({dateOfWeek:m,datas:A,sirkulasi:n})=>{const[o,y]=p.useState([]),[T,w]=p.useState({ml:{sirkulasi:0,angsuran:0,saldo:0},mb:{sirkulasi:0,angsuran:0,saldo:0},ccm:{sirkulasi:0,angsuran:0,saldo:0},cm:{sirkulasi:0,angsuran:0,saldo:0},all:{surkulasi:0,angsuran:0,saldo:0}});p.useEffect(()=>{if(A){const t=A.map((a,d)=>(()=>{const c={},g=(l=>{switch(l.type){case"ml":return(n==null?void 0:n.ml_amount)??0;case"mb":return(n==null?void 0:n.mb_amount)??0;case"cm":return(n==null?void 0:n.cm_amount)??0;default:return l.data.reduce((u,R)=>u+R.saldo_sebelumnya,0)}})(a);console.log(g),m.forEach(l=>{c[l]=0});let v=0;return a.data.forEach(l=>{m.forEach(u=>{l.instalment[u]!==void 0&&(v+=l.instalment[u].total_nominal,c[u]+=l.instalment[u].total_nominal)})}),w(l=>({...l,[a.type]:{sirkulasi:g,angsuran:v,saldo:g-v}})),{key:a.month,instalment:{...c},sirkulasi:g,totalInstalment:v,sirkulasiAfter:g-v,type:a.type}})());y(t)}},[A]);const k=(t,a)=>t.reduce((h,c)=>h+parseInt(c.instalment[a]??0),0),N=(t,a,d)=>t.reduce((c,S)=>d&&S.type==="normal"?c:c+parseInt(S[a]??0),0),[I,B]=p.useState(null),[C,F]=p.useState(!1),_=()=>{F(!1),B(null)},[j,b]=p.useState(!1),E=t=>{b(!0)},D=()=>{b(!1)};return i("div",{className:"relative overflow-auto h-[60vh] lg:h-[85vh] scrollbar-thin",children:[i(M,{className:"text-xs rounded-lg",children:[e(Y,{className:"sticky top-0 left-0 z-10",children:i(f,{className:"bg-gray-200",children:[e(x,{className:"text-center",children:"Bulan"}),e(x,{className:"text-center",children:"Sirkulasi"}),m.map((t,a)=>e(x,{className:"text-center",children:z(t).format("DD-MM-YY")},a)),e(x,{className:"text-center",children:"Angsuran"}),e(x,{className:"text-center",children:"Saldo"})]})}),e($,{children:o?o.map((t,a)=>e(H.Fragment,{children:i(f,{children:[e(r,{children:t.key}),e(r,{className:`${t.type=="normal"?"bg-green-200":""} `,children:e(s,{value:t.sirkulasi})}),m.map((d,h)=>e(r,{className:"text-center",children:e(s,{value:t.instalment[d]})},h)),e(r,{children:e(s,{value:t.totalInstalment})}),e(r,{children:e(s,{value:t.sirkulasiAfter})})]})},a)):e(f,{children:e(r,{children:"a"})})}),i(q,{children:[i(f,{children:[e(r,{rowSpan:2,className:"text-center",children:"Total"}),e(r,{className:"text-center",children:e(s,{value:N(o,"sirkulasi",!0)})}),e(r,{className:"text-center",colspan:m.length+2})]}),i(f,{children:[e(r,{className:"text-center",children:e(s,{value:N(o,"sirkulasi")})}),m.map((t,a)=>e(r,{className:"text-center",children:e(s,{value:k(o,t)})},a)),e(r,{className:"text-center",children:e(s,{value:N(o,"totalInstalment")})}),e(r,{className:"text-center",children:e(s,{value:N(o,"sirkulasiAfter")})})]})]})]}),i("div",{className:"flex items-center justify-end gap-3 mt-6",children:[e("div",{children:"Approval Akhir Bulan"}),e("div",{children:e(G,{onClick:E,variant:"green",size:"sm",children:"Approval"})})]}),e(K,{show:j,onClosed:D,datas:T}),e(J,{datas:o,show:C,onClosed:_,triggeredId:I})]})};export{ye as default};
