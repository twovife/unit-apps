import{r as m,q as z,W as E,j as s,a}from"./app-89964f60.js";import{C as T,a as B,b as P,d as H}from"./card-662026ea.js";import{L as C}from"./label-e1be8c98.js";import{I as M}from"./input-dda9d482.js";import{C as V}from"./index.esm-520ad08f.js";import{C as O}from"./Checkbox-e7d1ea02.js";import{B as p}from"./button-662018a0.js";import{L as W}from"./Loading-ceec09d3.js";import"./utils-aa679991.js";import"./index-bcb7b51f.js";import"./index-ea477c8f.js";import"./transition-16898277.js";const re=({triggeredId:g,triggeredPinjaman:v,instalment:b})=>{const[N,k]=m.useState({});m.useEffect(()=>{k(v)},[v]);const{server_filter:{closed_transaction:_,today:w}}=z().props,{data:c,setData:o,post:S,errors:G,processing:I,reset:j,recentlySuccessful:D}=E({type_transaksi:"bayar",transaction_date:"",nominal:0,id:""});m.useEffect(()=>{o("id",g)},[g,D]);const R=(e,n)=>{o(n,e)},y=e=>{o(e.target.name,e.target.type==="checkbox"?e.target.checked:e.target.value)},q=e=>{const n=e.target.getAttribute("data-value");o("nominal",n)},f=e=>{const n=parseInt(c.nominal),d=parseInt(e.target.getAttribute("data-value"));o("nominal",d+n)},A=e=>{e.preventDefault(),S(route("pinjaman.bayar_pinjaman",c.id),{preserveScroll:!0,onSuccess:()=>{j("transaction_date","nominal")}})},[x,F]=m.useState([5e4,52e3,6e4,65e3,1e5,13e4,195e3,26e4,39e4]);return m.useEffect(()=>{var e;if(o(n=>({...n,transaction_date:w})),b.length>0){const d=Number((u=>{const r=u.reduce((t,{nomor:i})=>(t[i]=(t[i]||0)+1,t),{});return Object.keys(r).reduce((t,i)=>r[t]>r[i]?t:i)})(b)),h=((e=b.sort((u,r)=>u.saldo-r.saldo)[0])==null?void 0:e.saldo)??0;F(u=>{const r=!isNaN(d)&&d>0?d:null,t=!isNaN(h)&&h>0?h:null;return[...new Set([...u.filter(l=>l!==r&&l!==t),r,t].filter(l=>l!==null))].sort((l,L)=>l-L)})}},[b]),s(T,{className:"relative w-full mb-3",children:[a(W,{show:I}),a(B,{children:a(P,{children:"Isi Angsuran"})}),a(H,{className:"relative",children:s("form",{onSubmit:A,children:[s("div",{className:"mb-3",children:[a(C,{htmlFor:"transaction_date",children:"Tanggal Pembayaran"}),a(M,{type:"date",min:_,name:"transaction_date",id:"transaction_date",className:"w-full",value:c.transaction_date,onChange:y})]}),s("div",{className:"mb-3",children:[a(C,{htmlFor:"nominal",children:"Nominal"}),a(V,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"nominal",allowDecimals:!1,prefix:"Rp. ",min:0,required:!0,onValueChange:R,value:c.nominal,placeholder:"Inputkan angka tanpa sparator"})]}),s("div",{className:"flex flex-wrap gap-3",children:[a(p,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":1e3,children:"+1 Rb"}),a(p,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":5e3,children:"+5 Rb"}),a(p,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":1e4,children:"+10 Rb"}),x&&x.map(e=>s(p,{type:"button",variant:"outline",size:"xs",onClick:q,"data-value":e,children:[(e/1e3).toLocaleString("id-ID")," Rb"]}))]}),s("div",{className:"flex items-center justify-between mt-6",children:[a("div",{children:N.status_pinjaman!=="normal"&&s("label",{className:"flex items-center",children:[a(O,{name:"danatitipan",value:c.danatitipan,onChange:y}),a("span",{className:"ml-2 text-sm text-gray-600",children:"Dana Titipan?"})]})}),a(p,{type:"submit",children:"Submit"})]})]})})]})};export{re as default};
