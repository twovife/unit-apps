import{r as m,X as z,G as E,j as s,a}from"./app-73b2c890.js";import{C as T,a as B,b as P,d as H}from"./card-7ab4d64e.js";import{L as C}from"./label-b0f83091.js";import{I as M}from"./input-890bf9fe.js";import{C as V}from"./index.esm-1f6c72c5.js";import{C as G}from"./Checkbox-bf9b7f05.js";import{B as p}from"./button-db0481f3.js";import{L as O}from"./Loading-a996aff5.js";import"./utils-3f044a58.js";import"./index-39f8c87a.js";import"./index-7fd90032.js";import"./index-ba2de68d.js";import"./transition-bf563f37.js";const se=({triggeredId:g,triggeredPinjaman:v,instalment:b})=>{const[N,k]=m.useState({});m.useEffect(()=>{k(v)},[v]);const{server_filter:{closed_transaction:_,today:w}}=z().props,{data:c,setData:o,post:S,errors:X,processing:I,reset:j,recentlySuccessful:D}=E({type_transaksi:"bayar",transaction_date:"",nominal:0,id:""});m.useEffect(()=>{o("id",g)},[g,D]);const R=(e,n)=>{o(n,e)},y=e=>{o(e.target.name,e.target.type==="checkbox"?e.target.checked:e.target.value)},A=e=>{const n=e.target.getAttribute("data-value");o("nominal",n)},f=e=>{const n=parseInt(c.nominal),d=parseInt(e.target.getAttribute("data-value"));o("nominal",d+n)},F=e=>{e.preventDefault(),S(route("pinjaman.bayar_pinjaman",c.id),{preserveScroll:!0,onSuccess:()=>{j("transaction_date","nominal")}})},[x,L]=m.useState([5e4,52e3,6e4,65e3,1e5,13e4,195e3,26e4,39e4]);return m.useEffect(()=>{var e;if(o(n=>({...n,transaction_date:w})),b.length>0){const d=Number((u=>{const r=u.reduce((t,{nomor:i})=>(t[i]=(t[i]||0)+1,t),{});return Object.keys(r).reduce((t,i)=>r[t]>r[i]?t:i)})(b)),h=((e=b.sort((u,r)=>u.saldo-r.saldo)[0])==null?void 0:e.saldo)??0;L(u=>{const r=!isNaN(d)&&d>0?d:null,t=!isNaN(h)&&h>0?h:null;return[...new Set([...u.filter(l=>l!==r&&l!==t),r,t].filter(l=>l!==null))].sort((l,q)=>l-q)})}},[b]),s(T,{className:"relative w-full mb-3",children:[a(O,{show:I}),a(B,{children:a(P,{children:"Isi Angsuran"})}),a(H,{className:"relative",children:s("form",{onSubmit:F,children:[s("div",{className:"mb-3",children:[a(C,{htmlFor:"transaction_date",children:"Tanggal Pembayaran"}),a(M,{type:"date",min:_,name:"transaction_date",id:"transaction_date",className:"w-full",value:c.transaction_date,onChange:y})]}),s("div",{className:"mb-3",children:[a(C,{htmlFor:"nominal",children:"Nominal"}),a(V,{className:"flex w-full px-3 py-1 text-sm transition-colors bg-transparent border rounded-md shadow-sm h-9 border-input file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",name:"nominal",allowDecimals:!1,prefix:"Rp. ",min:0,required:!0,onValueChange:R,value:c.nominal,placeholder:"Inputkan angka tanpa sparator"})]}),s("div",{className:"flex flex-wrap gap-3",children:[a(p,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":1e3,children:"+1 Rb"}),a(p,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":5e3,children:"+5 Rb"}),a(p,{type:"button",variant:"outline",size:"xs",onClick:f,"data-value":1e4,children:"+10 Rb"}),x&&x.map(e=>s(p,{type:"button",variant:"outline",size:"xs",onClick:A,"data-value":e,children:[(e/1e3).toLocaleString("id-ID")," Rb"]}))]}),s("div",{className:"flex items-center justify-between mt-6",children:[a("div",{children:N.status_pinjaman!=="normal"&&s("label",{className:"flex items-center",children:[a(G,{name:"danatitipan",value:c.danatitipan,onChange:y}),a("span",{className:"ml-2 text-sm text-gray-600",children:"Dana Titipan?"})]})}),a(p,{type:"submit",children:"Submit"})]})]})})]})};export{se as default};
